# ğŸ“‹ äº§å“éœ€æ±‚æ–‡æ¡£ (PRD)
# AIç§‘ç ”åŠ©æ‰‹ç³»ç»Ÿ v1.0

**æ–‡æ¡£ç‰ˆæœ¬**: v1.4 (æ–°å¢äº¤äº’å¼å›¾è°±å¯è§†åŒ–åŠŸèƒ½)  
**åˆ›å»ºæ—¥æœŸ**: 2025-12-09  
**æœ€åæ›´æ–°**: 2025-12-10  
**é¡¹ç›®ç»ç†**: [Your Name]  
**é¡¹ç›®ä»£å·**: ResearchAgent  
**é¢„è®¡äº¤ä»˜**: 2026-02-09ï¼ˆ2ä¸ªæœˆï¼‰

---

## ğŸ“‘ ç›®å½•

1. [äº§å“æ¦‚è¿°](#1-äº§å“æ¦‚è¿°)
2. [ç›®æ ‡ç”¨æˆ·ä¸åœºæ™¯](#2-ç›®æ ‡ç”¨æˆ·ä¸åœºæ™¯)
3. [äº§å“ç›®æ ‡](#3-äº§å“ç›®æ ‡)
4. [åŠŸèƒ½éœ€æ±‚](#4-åŠŸèƒ½éœ€æ±‚)
5. [æ•°æ®éœ€æ±‚](#5-æ•°æ®éœ€æ±‚)
6. [éåŠŸèƒ½éœ€æ±‚](#6-éåŠŸèƒ½éœ€æ±‚)
7. [æŠ€æœ¯æ¶æ„](#7-æŠ€æœ¯æ¶æ„)
8. [å¼€å‘åˆ†å·¥](#8-å¼€å‘åˆ†å·¥)
9. [é‡Œç¨‹ç¢‘ä¸äº¤ä»˜](#9-é‡Œç¨‹ç¢‘ä¸äº¤ä»˜)
10. [éªŒæ”¶æ ‡å‡†](#10-éªŒæ”¶æ ‡å‡†)
11. [é£é™©ç®¡ç†](#11-é£é™©ç®¡ç†)

---

## 1. äº§å“æ¦‚è¿°

### 1.1 äº§å“å®šä½

**AIç§‘ç ”åŠ©æ‰‹ç³»ç»Ÿ**æ˜¯ä¸€æ¬¾åŸºäºçŸ¥è¯†å›¾è°±çš„æ™ºèƒ½å­¦æœ¯ç ”ç©¶åŠ©æ‰‹ï¼Œæ—¨åœ¨é€šè¿‡è‡ªåŠ¨åŒ–çš„è®ºæ–‡è§£æã€çŸ¥è¯†æŠ½å–å’Œä¸ªæ€§åŒ–æ¨èï¼Œå¸®åŠ©ç§‘ç ”äººå‘˜é«˜æ•ˆç®¡ç†å­¦æœ¯ä¿¡æ¯ã€å‘ç°ç ”ç©¶æœºä¼šã€‚

### 1.2 æ ¸å¿ƒä»·å€¼ä¸»å¼ 

| ç—›ç‚¹ | è§£å†³æ–¹æ¡ˆ | ä»·å€¼ |
|-----|---------|------|
| æµ·é‡è®ºæ–‡éš¾ä»¥ç®¡ç† | è‡ªåŠ¨è§£æPDFï¼Œæ„å»ºçŸ¥è¯†å›¾è°± | èŠ‚çœ80%ä¿¡æ¯æ•´ç†æ—¶é—´ |
| çŸ¥è¯†ç¢ç‰‡åŒ– | å®ä½“å…³ç³»ç½‘ç»œï¼Œç»“æ„åŒ–çŸ¥è¯† | æå‡çŸ¥è¯†è¿æ¥æ•ˆç‡ |
| ç¼ºä¹ä¸ªæ€§åŒ– | ç”¨æˆ·ç”»åƒï¼Œæ™ºèƒ½æ¨è | ç²¾å‡†åŒ¹é…ç ”ç©¶å…´è¶£ |
| ä¿¡æ¯å­¤å²› | å¤–éƒ¨æœç´¢é›†æˆï¼Œè‡ªåŠ¨æ‰©å±• | è·å–æœ€æ–°ç ”ç©¶è¿›å±• |

### 1.3 æ ¸å¿ƒæŠ€æœ¯

- **çŸ¥è¯†å›¾è°±å¼•æ“**: Graphiti + Neo4j
- **AI Agent**: LangChain + OpenAI GPT-4
- **å‘é‡æœç´¢**: Sentence-Transformers
- **åç«¯æ¡†æ¶**: FastAPI + Celery

---

## 2. ç›®æ ‡ç”¨æˆ·ä¸åœºæ™¯

### 2.1 ç›®æ ‡ç”¨æˆ·ç”»åƒ

**ä¸»è¦ç”¨æˆ·**ï¼š
- ç ”ç©¶ç”Ÿï¼ˆç¡•å£«/åšå£«ï¼‰
- ç§‘ç ”å·¥ä½œè€…
- é«˜æ ¡æ•™å¸ˆ
- ä¼ä¸šç ”å‘äººå‘˜

**ç”¨æˆ·ç‰¹å¾**ï¼š
- æ¯å‘¨é˜…è¯»5-10ç¯‡è®ºæ–‡
- éœ€è¦è·Ÿè¸ªç‰¹å®šç ”ç©¶æ–¹å‘
- éœ€è¦ç®¡ç†å¤§é‡å­¦æœ¯èµ„æ–™
- æœ‰è®ºæ–‡å¯¹æ¯”å’Œç»¼è¿°éœ€æ±‚

### 2.2 å…¸å‹ä½¿ç”¨åœºæ™¯

#### åœºæ™¯1: æ–‡çŒ®è°ƒç ”
```
ç”¨æˆ·ï¼šå°æï¼ˆç ”ç©¶ç”Ÿï¼‰
ç›®æ ‡ï¼šè°ƒç ”è§†è§‰Transformeræœ€æ–°è¿›å±•
æµç¨‹ï¼š
1. æé—®ï¼š"æœ€è¿‘è§†è§‰Transformeræœ‰å“ªäº›æ”¹è¿›ï¼Ÿ"
2. ç³»ç»Ÿè‡ªåŠ¨æœç´¢ä¸ªäººå›¾è°± + å…¨å±€å›¾è°±
3. ä¿¡æ¯ä¸è¶³æ—¶è‡ªåŠ¨æœç´¢arXiv
4. ç”Ÿæˆç»“æ„åŒ–å›ç­”ï¼Œé™„å¼•ç”¨æ¥æº
5. è‡ªåŠ¨æ›´æ–°ç”¨æˆ·ç”»åƒ
```

#### åœºæ™¯2: è®ºæ–‡é˜…è¯»
```
ç”¨æˆ·ï¼šå°ç‹ï¼ˆç§‘ç ”å·¥ä½œè€…ï¼‰
ç›®æ ‡ï¼šå¿«é€Ÿç†è§£ä¸€ç¯‡æ–°è®ºæ–‡
æµç¨‹ï¼š
1. ä¸Šä¼ PDFæ–‡ä»¶
2. ç³»ç»Ÿè‡ªåŠ¨è§£æï¼šæå–æ–¹æ³•ã€æ•°æ®é›†ã€ç»“æœ
3. æ„å»ºçŸ¥è¯†å›¾è°±ï¼šè®ºæ–‡-æ–¹æ³•-ä»»åŠ¡å…³ç³»
4. ç”Ÿæˆæ‘˜è¦å’Œåˆ›æ–°ç‚¹
5. æ¨èç›¸å…³è®ºæ–‡
```

#### åœºæ™¯3: ç ”ç©¶è§„åˆ’
```
ç”¨æˆ·ï¼šå¼ æ•™æˆï¼ˆå¯¼å¸ˆï¼‰
ç›®æ ‡ï¼šä¸ºå­¦ç”Ÿè§„åˆ’ç ”ç©¶æ–¹å‘
æµç¨‹ï¼š
1. æŸ¥çœ‹å­¦ç”Ÿçš„ç”¨æˆ·ç”»åƒ
2. æŸ¥çœ‹å­¦ç”Ÿé˜…è¯»å†å²å’Œå…´è¶£æ ‡ç­¾
3. ç³»ç»Ÿæ¨èæ½œåœ¨ç ”ç©¶æ–¹å‘
4. å¯¹æ¯”ä¸åŒæ–¹å‘çš„è®ºæ–‡
5. ç”Ÿæˆç ”ç©¶å»ºè®®
```

---

## 3. äº§å“ç›®æ ‡

### 3.1 ä¸šåŠ¡ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | è¡¡é‡æ–¹å¼ |
|-----|--------|---------|
| ç”¨æˆ·ç•™å­˜ç‡ | > 70% | æœˆæ´»è·ƒç”¨æˆ·æ•° |
| å¹³å‡ä½¿ç”¨æ—¶é•¿ | > 30åˆ†é’Ÿ/å‘¨ | ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡ |
| è®ºæ–‡è§£æå‡†ç¡®ç‡ | > 85% | äººå·¥æŠ½æ ·éªŒè¯ |
| æ¨èç²¾å‡†åº¦ | > 60% | ç”¨æˆ·åé¦ˆ |
| æŸ¥è¯¢å“åº”æ—¶é—´ | < 3ç§’ | APIç›‘æ§ |

### 3.2 æŠ€æœ¯ç›®æ ‡

- âœ… å›¾è°±èŠ‚ç‚¹æ•°: æ”¯æŒ10ä¸‡+
- âœ… å¹¶å‘ç”¨æˆ·æ•°: 100+
- âœ… APIå¯ç”¨æ€§: 99.5%
- âœ… æ•°æ®å‡†ç¡®æ€§: 90%+
- âœ… ç³»ç»Ÿæ‰©å±•æ€§: æ¨¡å—åŒ–ï¼Œæ˜“æ‰©å±•

### 3.3 MVPç›®æ ‡ï¼ˆç¬¬ä¸€ç‰ˆæœ¬ï¼‰

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. è®ºæ–‡PDFä¸Šä¼ å’Œè§£æ
2. åŸºäºå›¾è°±çš„æ™ºèƒ½é—®ç­”
3. ç”¨æˆ·ä¸ªäººå›¾è°±ç®¡ç†
4. åŸºç¡€æ¨èåŠŸèƒ½

**æ’é™¤åŠŸèƒ½**ï¼ˆå»¶ååˆ°v2.0ï¼‰ï¼š
- å‰ç«¯UIï¼ˆç”±å‰ç«¯å›¢é˜Ÿè´Ÿè´£ï¼‰
- ç”¨æˆ·æƒé™ç®¡ç†
- å¤šè¯­è¨€æ”¯æŒ
- ç§»åŠ¨ç«¯é€‚é…
- ç”¨æˆ·ç”»åƒæ„å»º
- é˜…è¯»å†å²è¿½è¸ª
- è®ºæ–‡æ¨è
- è®ºæ–‡å¯¹æ¯”

---

## 4. åŠŸèƒ½éœ€æ±‚

### 4.1 åŠŸèƒ½æ¨¡å—æ€»è§ˆ

```
ResearchAgent v1.0
â”œâ”€â”€ ğŸ” ç”¨æˆ·è®¤è¯æ¨¡å—
â”œâ”€â”€ ğŸ“¥ è®ºæ–‡ç®¡ç†æ¨¡å—
â”œâ”€â”€ ğŸ§  çŸ¥è¯†å›¾è°±æ¨¡å—
â”œâ”€â”€ ğŸ’¬ æ™ºèƒ½é—®ç­”æ¨¡å—
â”œâ”€â”€ ğŸ‘¤ ç”¨æˆ·ç”»åƒæ¨¡å—
â”œâ”€â”€ ğŸ” æœç´¢ä¸æ¨èæ¨¡å—
â””â”€â”€ ğŸ“Š å¯è§†åŒ–æ¨¡å—
```

---

### 4.2 æ¨¡å—H: ç”¨æˆ·è®¤è¯æ¨¡å—

**è´Ÿè´£äºº**: @åç«¯å¼€å‘H  
**ä¼˜å…ˆçº§**: P0ï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰  
**é¢„è®¡å·¥æœŸ**: 1å‘¨

#### åŠŸèƒ½éœ€æ±‚

##### H1: ç”¨æˆ·æ³¨å†Œ (REQ-H1)

**éœ€æ±‚æè¿°**:  
ç”¨æˆ·å¯ä»¥é€šè¿‡é‚®ç®±æ³¨å†Œè´¦å·ï¼Œç³»ç»Ÿéœ€è¦éªŒè¯é‚®ç®±å”¯ä¸€æ€§å¹¶å®‰å…¨å­˜å‚¨å¯†ç ã€‚

**APIç«¯ç‚¹**: `POST /api/auth/register`

**è¯·æ±‚å‚æ•°**:
```json
{
  "username": "zhangsan",
  "email": "zhangsan@example.com",
  "password": "SecurePassword123!"
}
```

**å¤„ç†æµç¨‹**:
```
æ¥æ”¶æ³¨å†Œä¿¡æ¯
  â†“
æ£€æŸ¥é‚®ç®±å”¯ä¸€æ€§
  â†“
å¯†ç åŠ å¯†ï¼ˆbcrypt, cost=12ï¼‰
  â†“
å†™å…¥MySQL usersè¡¨
  â†“
ç”ŸæˆJWT Token
  â†“
è¿”å›ç”¨æˆ·ä¿¡æ¯å’ŒToken
```

**è¯´æ˜**ï¼šé‚®ç®±æ ¼å¼éªŒè¯ã€å¯†ç å¼ºåº¦éªŒè¯ç”±å‰ç«¯è´Ÿè´£ï¼Œåç«¯åªåšä¸šåŠ¡é€»è¾‘éªŒè¯ã€‚

**å“åº”ç¤ºä¾‹**:
```json
{
  "user": {
    "user_id": "u_1234567890",
    "username": "zhangsan",
    "email": "zhangsan@example.com",
    "created_at": "2024-01-15T10:30:00Z"
  },
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "Bearer",
  "expires_in": 3600
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] é‚®ç®±å”¯ä¸€æ€§éªŒè¯
- [ ] å¯†ç ä½¿ç”¨bcryptåŠ å¯†ï¼ˆcost=12ï¼‰
- [ ] å“åº”æ—¶é—´ < 1ç§’
- [ ] é”™è¯¯æç¤ºæ¸…æ™°ï¼ˆé‚®ç®±å·²å­˜åœ¨ç­‰ï¼‰

**æµ‹è¯•ç”¨ä¾‹**:
```python
# TC-H1-001: æ­£å¸¸æ³¨å†Œ
def test_register_success():
    response = client.post("/api/auth/register", json={
        "username": "testuser",
        "email": "test@example.com",
        "password": "Test1234!",
        "confirm_password": "Test1234!"
    })
    assert response.status_code == 201
    assert "access_token" in response.json()

# TC-H1-002: é‚®ç®±å·²å­˜åœ¨
def test_register_duplicate_email():
    response = client.post("/api/auth/register", json={
        "email": "existing@example.com",
        ...
    })
    assert response.status_code == 400
    assert "email already exists" in response.json()["detail"]

```

---

##### H2: ç”¨æˆ·ç™»å½• (REQ-H2)

**éœ€æ±‚æè¿°**:  
ç”¨æˆ·é€šè¿‡é‚®ç®±å’Œå¯†ç ç™»å½•ï¼Œç³»ç»ŸéªŒè¯å‡­è¯å¹¶è¿”å›JWT Tokenã€‚

**APIç«¯ç‚¹**: `POST /api/auth/login`

**è¯·æ±‚å‚æ•°**:
```json
{
  "email": "zhangsan@example.com",
  "password": "SecurePassword123!"
}
```

**å¤„ç†æµç¨‹**:
```
æ¥æ”¶ç™»å½•å‡­è¯
  â†“
æŸ¥è¯¢ç”¨æˆ·ï¼ˆby emailï¼‰
  â†“
éªŒè¯å¯†ç ï¼ˆbcrypt.verifyï¼‰
  â†“
ç”ŸæˆJWT Token
  - access_token (æœ‰æ•ˆæœŸ: 1å°æ—¶)
  - refresh_token (æœ‰æ•ˆæœŸ: 7å¤©)
  â†“
æ›´æ–°last_loginæ—¶é—´
  â†“
è¿”å›Tokenå’Œç”¨æˆ·ä¿¡æ¯
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "user": {
    "user_id": "u_1234567890",
    "username": "zhangsan",
    "email": "zhangsan@example.com"
  },
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "Bearer",
  "expires_in": 3600
}
```

**JWT Tokenå†…å®¹**:
```json
{
  "sub": "u_1234567890",  // user_id
  "email": "zhangsan@example.com",
  "exp": 1704456789,  // è¿‡æœŸæ—¶é—´
  "iat": 1704453189   // ç­¾å‘æ—¶é—´
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®éªŒè¯ç”¨æˆ·å‡­è¯
- [ ] ç”Ÿæˆæœ‰æ•ˆçš„JWT Token
- [ ] æ›´æ–°ç™»å½•æ—¶é—´
- [ ] å“åº”æ—¶é—´ < 500ms
- [ ] é”™è¯¯æç¤ºæ¸…æ™°ï¼ˆç”¨æˆ·ä¸å­˜åœ¨ã€å¯†ç é”™è¯¯ï¼‰
- [ ] ç™»å½•å¤±è´¥3æ¬¡åé”å®šè´¦æˆ·ï¼ˆ5åˆ†é’Ÿï¼‰

---

##### H3: Tokenåˆ·æ–° (REQ-H3)

**éœ€æ±‚æè¿°**:  
ä½¿ç”¨refresh_tokenè·å–æ–°çš„access_tokenï¼Œé¿å…ç”¨æˆ·é¢‘ç¹ç™»å½•ã€‚

**APIç«¯ç‚¹**: `POST /api/auth/refresh`

**è¯·æ±‚å‚æ•°**:
```json
{
  "refresh_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "Bearer",
  "expires_in": 3600
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] éªŒè¯refresh_tokenæœ‰æ•ˆæ€§
- [ ] ç”Ÿæˆæ–°çš„access_token
- [ ] å“åº”æ—¶é—´ < 200ms

---

##### H4: ç”¨æˆ·ç™»å‡º (REQ-H4)

**éœ€æ±‚æè¿°**:  
ç”¨æˆ·ç™»å‡ºæ—¶ï¼Œå°†TokenåŠ å…¥é»‘åå•ï¼ˆä½¿ç”¨Redisï¼‰ã€‚

**APIç«¯ç‚¹**: `POST /api/auth/logout`

**è¯·æ±‚Header**:
```
Authorization: Bearer <access_token>
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "message": "Successfully logged out"
}
```

**æŠ€æœ¯å®ç°**:
```python
# å°†TokenåŠ å…¥Redisé»‘åå•
redis_client.setex(
    f"blacklist:{token}",
    ttl=token_remaining_time,
    value="1"
)
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] TokenæˆåŠŸåŠ å…¥é»‘åå•
- [ ] é»‘åå•Tokenæ— æ³•è®¿é—®å—ä¿æŠ¤API
- [ ] Redis TTLè®¾ç½®æ­£ç¡®

---

##### H5: ç”¨æˆ·ä¿¡æ¯è·å– (REQ-H5)

**éœ€æ±‚æè¿°**:  
è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„ä¿¡æ¯ã€‚

**APIç«¯ç‚¹**: `GET /api/auth/me`

**è¯·æ±‚Header**:
```
Authorization: Bearer <access_token>
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "user_id": "u_1234567890",
  "username": "zhangsan",
  "email": "zhangsan@example.com",
  "created_at": "2024-01-15T10:30:00Z",
  "last_login": "2024-01-20T14:30:00Z"
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®è§£æJWT Token
- [ ] è¿”å›å®Œæ•´ç”¨æˆ·ä¿¡æ¯
- [ ] å“åº”æ—¶é—´ < 200ms

---

##### H6: å¯†ç ä¿®æ”¹ (REQ-H6)

**éœ€æ±‚æè¿°**:  
ç”¨æˆ·å¯ä»¥ä¿®æ”¹è‡ªå·±çš„å¯†ç ã€‚

**APIç«¯ç‚¹**: `POST /api/auth/change-password`

**è¯·æ±‚å‚æ•°**:
```json
{
  "old_password": "OldPassword123!",
  "new_password": "NewPassword456!"
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] éªŒè¯æ—§å¯†ç æ­£ç¡®
- [ ] å¯†ç åŠ å¯†å­˜å‚¨

**è¯´æ˜**ï¼šæ–°å¯†ç å¼ºåº¦éªŒè¯ã€ä¸¤æ¬¡æ–°å¯†ç ä¸€è‡´æ€§éªŒè¯ç”±å‰ç«¯è´Ÿè´£ã€‚

---

##### H7: JWTä¸­é—´ä»¶ (REQ-H7)

**éœ€æ±‚æè¿°**:  
å®ç°JWTè®¤è¯ä¸­é—´ä»¶ï¼Œä¿æŠ¤éœ€è¦ç™»å½•çš„APIã€‚

**æŠ€æœ¯å®ç°**:
```python
# app/api/dependencies/auth.py

from fastapi import Depends, HTTPException, status
from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials
from jose import JWTError, jwt

security = HTTPBearer()

async def get_current_user(
    credentials: HTTPAuthorizationCredentials = Depends(security)
) -> dict:
    """
    JWTè®¤è¯ä¾èµ–
    éªŒè¯Tokenå¹¶è¿”å›å½“å‰ç”¨æˆ·ä¿¡æ¯
    """
    token = credentials.credentials
    
    # 1. æ£€æŸ¥Tokenæ˜¯å¦åœ¨é»‘åå•
    if redis_client.exists(f"blacklist:{token}"):
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Token has been revoked"
        )
    
    # 2. éªŒè¯Token
    try:
        payload = jwt.decode(
            token, 
            settings.SECRET_KEY, 
            algorithms=[settings.ALGORITHM]
        )
        user_id = payload.get("sub")
        if user_id is None:
            raise HTTPException(
                status_code=status.HTTP_401_UNAUTHORIZED,
                detail="Invalid token"
            )
    except JWTError:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="Could not validate credentials"
        )
    
    # 3. ä»æ•°æ®åº“è·å–ç”¨æˆ·ä¿¡æ¯
    user = await get_user_by_id(user_id)
    if user is None:
        raise HTTPException(
            status_code=status.HTTP_401_UNAUTHORIZED,
            detail="User not found"
        )
    
    return user
```

**ä½¿ç”¨ç¤ºä¾‹**:
```python
@router.post("/api/chat")
async def chat(
    request: ChatRequest,
    current_user: dict = Depends(get_current_user)  # éœ€è¦ç™»å½•
):
    user_id = current_user["user_id"]
    # ... ä¸šåŠ¡é€»è¾‘
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®éªŒè¯Token
- [ ] å¤„ç†è¿‡æœŸToken
- [ ] å¤„ç†é»‘åå•Token
- [ ] å¤„ç†æ— æ•ˆToken
- [ ] æ€§èƒ½å½±å“ < 50ms

---

### 4.3 æ¨¡å—A: è®ºæ–‡ç®¡ç†æ¨¡å—

**è´Ÿè´£äºº**: @åç«¯å¼€å‘A  
**ä¼˜å…ˆçº§**: P0ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰  
**é¢„è®¡å·¥æœŸ**: 2å‘¨  
**ä¾èµ–**: Module Hï¼ˆç”¨æˆ·è®¤è¯ï¼‰

#### åŠŸèƒ½éœ€æ±‚

##### A1: è®ºæ–‡ä¸Šä¼  (REQ-A1)

**éœ€æ±‚æè¿°**:  
ç”¨æˆ·å¯ä»¥ä¸Šä¼ PDFæ ¼å¼çš„å­¦æœ¯è®ºæ–‡ï¼Œç³»ç»Ÿè‡ªåŠ¨è§£æè®ºæ–‡å†…å®¹å¹¶æ„å»ºçŸ¥è¯†å›¾è°±ã€‚

**è¾“å…¥**:
- PDFæ–‡ä»¶ï¼ˆ< 50MBï¼‰
- ç”¨æˆ·ID
- å¯é€‰ï¼šè®ºæ–‡å…ƒæ•°æ®ï¼ˆæ ‡é¢˜ã€ä½œè€…ç­‰ï¼‰

**å¤„ç†æµç¨‹**:
```
PDFä¸Šä¼ 
  â†“
æ–‡ä»¶å­˜å‚¨ï¼ˆtemp/uploads/ï¼‰
  â†“
å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼ˆCeleryï¼‰
  â†“
PDFè§£æï¼ˆPyMuPDFï¼‰
  â”œâ”€ æå–æ–‡æœ¬
  â”œâ”€ æå–å…ƒæ•°æ®
  â””â”€ è¯†åˆ«ç« èŠ‚ç»“æ„
  â†“
æ–‡æœ¬åˆ†å—ï¼ˆæŒ‰sectionï¼‰
  â†“
è°ƒç”¨Graphiti.add_episode API
  â”œâ”€ è‡ªåŠ¨LLMå®ä½“æŠ½å–ï¼ˆPaperã€Methodã€Datasetã€Taskç­‰ï¼‰
  â”œâ”€ è‡ªåŠ¨å…³ç³»æŠ½å–ï¼ˆPROPOSESã€EVALUATES_ONç­‰ï¼‰
  â””â”€ å†™å…¥å›¾è°±ï¼ˆç”¨æˆ·å›¾è°± user:xxx æˆ–å…¨å±€å›¾è°± globalï¼‰
  â†“
è¿”å›è§£æç»“æœ
```

**è¾“å‡º**:
```json
{
  "paper_id": "uuid-xxx",
  "status": "completed",
  "entities_count": 25,
  "relations_count": 18,
  "summary": "æœ¬æ–‡æå‡ºäº†...",
  "key_methods": ["SwinV3", "TokenMixing"],
  "datasets": ["ImageNet", "COCO"],
  "processing_time": 45.2
}
```

**æŠ€æœ¯è§„æ ¼**:
- APIç«¯ç‚¹: `POST /api/papers/upload`
- ä¾èµ–æœåŠ¡: `IngestService`, `PDFParser`
- å¼‚æ­¥ä»»åŠ¡: `ingest_pdf_task`
- Graphitiæ–¹æ³•: `graphiti.add_episode()`ï¼ˆå†…éƒ¨è°ƒç”¨LLMè¿›è¡Œå®ä½“æŠ½å–ï¼‰
- è¶…æ—¶è®¾ç½®: 5åˆ†é’Ÿ

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ”¯æŒPDFä¸Šä¼ ï¼ˆ< 50MBï¼‰
- [ ] è§£æå‡†ç¡®ç‡ > 80%ï¼ˆäººå·¥æŠ½æ ·10ç¯‡ï¼‰
- [ ] å®ä½“æŠ½å–è¦†ç›–ç‡ > 85%
- [ ] å¤„ç†æ—¶é—´ < 2åˆ†é’Ÿï¼ˆæ ‡å‡†è®ºæ–‡ï¼‰
- [ ] å¼‚æ­¥ä»»åŠ¡å¯ç›‘æ§çŠ¶æ€
- [ ] é”™è¯¯å¤„ç†å®Œå–„ï¼ˆæ ¼å¼é”™è¯¯ã€è§£æå¤±è´¥ç­‰ï¼‰

**æµ‹è¯•ç”¨ä¾‹**:
```python
# TC-A1-001: æ­£å¸¸ä¸Šä¼ 
def test_upload_valid_pdf():
    response = client.post("/api/papers/upload", 
                           files={"file": valid_pdf})
    assert response.status_code == 200
    assert "paper_id" in response.json()

# TC-A1-002: æ–‡ä»¶è¿‡å¤§
def test_upload_large_pdf():
    response = client.post("/api/papers/upload",
                           files={"file": large_pdf})
    assert response.status_code == 413

# TC-A1-003: æ ¼å¼é”™è¯¯
def test_upload_invalid_format():
    response = client.post("/api/papers/upload",
                           files={"file": txt_file})
    assert response.status_code == 400
```

---

##### A2: è®ºæ–‡è¯¦æƒ… (REQ-A2)

**éœ€æ±‚æè¿°**:  
è·å–è®ºæ–‡çš„å®Œæ•´ç»“æ„åŒ–ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–¹æ³•ã€æ•°æ®é›†ã€ç»“æœç­‰ã€‚

**éœ€æ±‚æè¿°**:  
è·å–è®ºæ–‡çš„å®Œæ•´ç»“æ„åŒ–ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–¹æ³•ã€æ•°æ®é›†ã€ç»“æœç­‰ã€‚

**APIç«¯ç‚¹**: `GET /api/papers/{paper_id}`

**å“åº”ç¤ºä¾‹**:
```json
{
  "paper_id": "uuid-1",
  "title": "Swin Transformer V3",
  "authors": [...],
  "abstract": "...",
  "sections": [
    {"title": "Introduction", "content": "..."},
    {"title": "Method", "content": "..."}
  ],
  "entities": {
    "methods": ["SwinV3", "TokenMixing"],
    "datasets": ["ImageNet", "COCO"],
    "tasks": ["Image Classification"]
  },
  "relations": [
    {"type": "PROPOSES", "target": "SwinV3"},
    {"type": "EVALUATES_ON", "target": "ImageNet"}
  ],
  "citations_count": 125,
  "related_papers": [...]
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] è¿”å›å®Œæ•´è®ºæ–‡ä¿¡æ¯
- [ ] åŒ…å«å®ä½“å’Œå…³ç³»
- [ ] åŒ…å«ç›¸å…³è®ºæ–‡æ¨è
- [ ] å“åº”æ—¶é—´ < 500ms

---

### 4.3 æ¨¡å—B: çŸ¥è¯†å›¾è°±æ¨¡å—

**è´Ÿè´£äºº**: @åç«¯å¼€å‘B  
**ä¼˜å…ˆçº§**: P0ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰  
**é¢„è®¡å·¥æœŸ**: 3å‘¨

#### åŠŸèƒ½éœ€æ±‚

##### B1: å›¾è°±æœç´¢ (REQ-B1)

**éœ€æ±‚æè¿°**:  
æä¾›æ··åˆæœç´¢ï¼ˆè¯­ä¹‰ + BM25ï¼‰å’ŒèŠ‚ç‚¹è·ç¦»é‡æ’åŠŸèƒ½ï¼Œæ”¯æŒåŒå›¾è°±æ¶æ„ã€‚

**APIç«¯ç‚¹**: `POST /api/graph/search`

**è¯·æ±‚å‚æ•°**:
```json
{
  "query": "attention mechanism in transformers",
  "user_id": "user123",
  "search_scope": "auto",  // auto | user | global
  "rerank_mode": "rrf",    // rrf | mmr | cross_encoder
  "focal_node_uuid": null,  // å¯é€‰ï¼šä¸­å¿ƒèŠ‚ç‚¹
  "limit": 20
}
```

**å¤„ç†é€»è¾‘**:
```python
# åŒå›¾è°±Fallbackæœºåˆ¶
def search_with_fallback(query, user_id):
    # 1. æœç´¢ç”¨æˆ·å›¾è°±
    user_results = graphiti.search(query, group_id=f"user:{user_id}")
    
    # 2. å¦‚æœç»“æœä¸è¶³ï¼Œæœç´¢å…¨å±€å›¾è°±
    if len(user_results) < threshold:
        global_results = graphiti.search(query, group_id="global")
        results = merge_results(user_results, global_results)
    
    # 3. å¦‚æœä»ä¸è¶³ï¼Œè§¦å‘å¤–éƒ¨æœç´¢
    if len(results) < threshold:
        trigger_external_search(query, user_id)
    
    return results
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "results": [
    {
      "node_id": "uuid-1",
      "node_type": "Method",
      "name": "Self-Attention",
      "summary": "...",
      "relevance_score": 0.95,
      "source": "user_graph"
    }
  ],
  "search_strategy": "user_then_global",
  "external_search_triggered": false,
  "total": 18
}
```

**æŠ€æœ¯è§„æ ¼**:
- ä¾èµ–: `GraphService`, `NamespaceService`, `GraphitiClient`
- Graphitiæ–¹æ³•: `graphiti.search()`, `graphiti._search()`
- æœç´¢é…ç½®: ä½¿ç”¨`SearchConfig`è‡ªå®šä¹‰å‚æ•°

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ··åˆæœç´¢æ­£ç¡®å®ç°
- [ ] åŒå›¾è°±Fallbackæ­£ç¡®
- [ ] æ”¯æŒ3ç§é‡æ’æ¨¡å¼
- [ ] æœç´¢å“åº”æ—¶é—´ < 2ç§’
- [ ] æœç´¢ç»“æœç›¸å…³æ€§ > 70%ï¼ˆäººå·¥è¯„ä¼°ï¼‰

---

##### B2: èŠ‚ç‚¹æŸ¥è¯¢ (REQ-B2)

**éœ€æ±‚æè¿°**:  
é€šè¿‡UUIDè·å–èŠ‚ç‚¹è¯¦æƒ…ï¼ŒåŒ…æ‹¬é‚»å±…èŠ‚ç‚¹ã€‚

**APIç«¯ç‚¹**: `GET /api/graph/node/{uuid}`

**å“åº”ç¤ºä¾‹**:
```json
{
  "node": {
    "uuid": "uuid-1",
    "type": "Method",
    "name": "Vision Transformer",
    "properties": {...},
    "summary": "...",
    "created_at": "2024-01-15T10:30:00Z"
  },
  "neighbors": [
    {
      "uuid": "uuid-2",
      "type": "Paper",
      "name": "An Image is Worth 16x16 Words",
      "relation": "PROPOSED_BY",
      "distance": 1
    }
  ],
  "communities": ["Computer Vision", "Transformers"]
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®è¿”å›èŠ‚ç‚¹ä¿¡æ¯
- [ ] åŒ…å«1-hopé‚»å±…
- [ ] åŒ…å«ç¤¾åŒºä¿¡æ¯
- [ ] å“åº”æ—¶é—´ < 500ms

---

##### B3: è·¯å¾„æŸ¥è¯¢ (REQ-B3)

**éœ€æ±‚æè¿°**:  
æŸ¥æ‰¾ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»è·¯å¾„ã€‚

**APIç«¯ç‚¹**: `POST /api/graph/path`

**è¯·æ±‚å‚æ•°**:
```json
{
  "source_uuid": "uuid-1",
  "target_uuid": "uuid-2",
  "max_depth": 3
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "paths": [
    {
      "length": 2,
      "nodes": [
        {"uuid": "uuid-1", "name": "ViT"},
        {"uuid": "uuid-3", "name": "BERT"},
        {"uuid": "uuid-2", "name": "Transformer"}
      ],
      "relations": ["IMPROVES_OVER", "BASED_ON"]
    }
  ]
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ‰¾åˆ°æœ€çŸ­è·¯å¾„
- [ ] æ”¯æŒå¤šæ¡è·¯å¾„è¿”å›
- [ ] æœ€å¤§æ·±åº¦é™åˆ¶ç”Ÿæ•ˆ
- [ ] è¶…æ—¶ä¿æŠ¤ï¼ˆ5ç§’ï¼‰

---

##### B4: Schemaå®šä¹‰ (REQ-B4)

**éœ€æ±‚æè¿°**:  
å®šä¹‰8ç§å®ä½“ç±»å‹å’Œ9ç§å…³ç³»ç±»å‹ï¼Œä½¿ç”¨PydanticéªŒè¯ã€‚

**å®ä½“ç±»å‹**:
```python
# app/schemas/entities.py

class PaperEntity(BaseModel):
    title: str
    arxiv_id: Optional[str]
    doi: Optional[str]
    abstract: str
    year: int
    venue: Optional[str]
    authors: List[str]

class MethodEntity(BaseModel):
    name: str
    description: str
    category: Optional[str]

class DatasetEntity(BaseModel):
    name: str
    description: Optional[str]
    domain: Optional[str]

# ... å…¶ä»–5ç§å®ä½“
```

**å…³ç³»ç±»å‹**:
```python
# app/schemas/relations.py

class RelationType(str, Enum):
    PROPOSES = "PROPOSES"
    EVALUATES_ON = "EVALUATES_ON"
    SOLVES = "SOLVES"
    IMPROVES_OVER = "IMPROVES_OVER"
    CITES = "CITES"
    USES_METRIC = "USES_METRIC"
    AUTHORED_BY = "AUTHORED_BY"
    AFFILIATED_WITH = "AFFILIATED_WITH"
    HAS_CONCEPT = "HAS_CONCEPT"
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] 8ç§å®ä½“ç±»å‹å®Œæ•´å®šä¹‰
- [ ] 9ç§å…³ç³»ç±»å‹å®Œæ•´å®šä¹‰
- [ ] PydanticéªŒè¯é€šè¿‡
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 90%

---

### 4.4 æ¨¡å—C: æ™ºèƒ½é—®ç­”æ¨¡å—

**è´Ÿè´£äºº**: @åç«¯å¼€å‘C  
**ä¼˜å…ˆçº§**: P0ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰  
**é¢„è®¡å·¥æœŸ**: 3å‘¨

#### åŠŸèƒ½éœ€æ±‚

##### C1: Agentå¯¹è¯ (REQ-C1)

**éœ€æ±‚æè¿°**:  
ç”¨æˆ·å¯ä»¥å‘Agentæé—®ï¼ŒAgentè‡ªåŠ¨è°ƒç”¨å·¥å…·ã€èšåˆä¸Šä¸‹æ–‡ã€ç”Ÿæˆå›ç­”ã€‚

**APIç«¯ç‚¹**: `POST /api/chat`

**è¯·æ±‚å‚æ•°**:
```json
{
  "user_id": "user123",
  "message": "æœ€è¿‘è§†è§‰Transformeræœ‰å“ªäº›æ”¹è¿›ï¼Ÿ",
  "session_id": "session-456",
  "context": []  // å¯é€‰ï¼šå†å²ä¸Šä¸‹æ–‡
}
```

**Agentå·¥ä½œæµç¨‹**:
```
æ¥æ”¶ç”¨æˆ·æ¶ˆæ¯
  â†“
ã€æ„å›¾ç†è§£ã€‘
  LLMåˆ†æï¼šéœ€è¦æœç´¢ViTç›¸å…³è®ºæ–‡
  â†“
ã€å·¥å…·é€‰æ‹©ã€‘
  é€‰ä¸­å·¥å…·ï¼š
    - graph_query_tool
    - external_search_tool
  â†“
ã€å·¥å…·æ‰§è¡Œã€‘
  graph_query_tool.execute("vision transformer", user_id)
    â†’ è¿”å›20ä¸ªç»“æœ
  
  åˆ¤æ–­ï¼šç»“æœå……è¶³ï¼Ÿ
    No â†’ external_search_tool.execute("ViT improvements 2024")
           â†’ arXivæœç´¢ â†’ è‡ªåŠ¨æ‘„å…¥5ç¯‡æ–°è®ºæ–‡
  â†“
ã€ä¸Šä¸‹æ–‡èšåˆã€‘
  - å›¾è°±æœç´¢ç»“æœ
  - ç”¨æˆ·é˜…è¯»å†å²
  - ç”¨æˆ·å…´è¶£æ ‡ç­¾
  â†“
ã€å›ç­”ç”Ÿæˆã€‘
  LLMç”Ÿæˆç»“æ„åŒ–å›ç­” + å¼•ç”¨æ¥æº
  â†“
ã€åå¤„ç†ã€‘
  - ä¿å­˜èŠå¤©å†å²
  - æ›´æ–°ç”¨æˆ·ç”»åƒ
  â†“
è¿”å›å›ç­”
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "reply": "è¿‘ä¸¤å¹´è§†è§‰Transformerçš„ä¸»è¦æ”¹è¿›åŒ…æ‹¬ï¼š\n\n1. **ç»“æ„ä¼˜åŒ–**ï¼šSwin Transformer V3å¼•å…¥äº†Token-Mixing Normalization...\n\n2. **è®­ç»ƒæ•ˆç‡**ï¼šDeiT IIIé€šè¿‡...\n\n3. **åº”ç”¨æ‰©å±•**ï¼šMedViTå°†ViTåº”ç”¨äºåŒ»å­¦å½±åƒ...",
  "citations": [
    {
      "text": "Token-Mixing Normalization",
      "source_type": "paper",
      "source_id": "uuid-1",
      "source_name": "Swin Transformer V3"
    }
  ],
  "tools_used": ["graph_query", "external_search"],
  "graph_results_count": 20,
  "external_papers_added": 5,
  "confidence": 0.87,
  "session_id": "session-456"
}
```

**æŠ€æœ¯è§„æ ¼**:
- ä¾èµ–: `AgentService`, `ToolRegistry`, `LLMClient`
- LLMæ¨¡å‹: GPT-4 (gpt-4-turbo)
- å·¥å…·è°ƒç”¨: Function Calling API
- ä¸Šä¸‹æ–‡çª—å£: 16K tokens

**éªŒæ”¶æ ‡å‡†**:
- [ ] Agentèƒ½ç†è§£ç”¨æˆ·æ„å›¾
- [ ] æ­£ç¡®é€‰æ‹©å’Œè°ƒç”¨å·¥å…·
- [ ] å›ç­”åŒ…å«å¼•ç”¨æ¥æº
- [ ] å›ç­”è´¨é‡ > 4/5ï¼ˆäººå·¥è¯„åˆ†ï¼‰
- [ ] å“åº”æ—¶é—´ < 10ç§’
- [ ] é”™è¯¯å¤„ç†å®Œå–„

**æµ‹è¯•ç”¨ä¾‹**:
```python
# TC-C1-001: åŸºç¡€é—®ç­”
def test_basic_chat():
    response = client.post("/api/chat", json={
        "user_id": "test_user",
        "message": "ä»€ä¹ˆæ˜¯Vision Transformerï¼Ÿ"
    })
    assert response.status_code == 200
    assert "reply" in response.json()
    assert len(response.json()["citations"]) > 0

# TC-C1-002: è§¦å‘å¤–éƒ¨æœç´¢
def test_external_search_trigger():
    response = client.post("/api/chat", json={
        "user_id": "test_user",
        "message": "2024å¹´æœ€æ–°çš„ViTè®ºæ–‡æœ‰å“ªäº›ï¼Ÿ"
    })
    result = response.json()
    assert "external_search" in result["tools_used"]

# TC-C1-003: é•¿å¯¹è¯
def test_multi_turn_chat():
    # ç¬¬ä¸€è½®
    r1 = client.post("/api/chat", json={
        "user_id": "test_user",
        "message": "ä»€ä¹ˆæ˜¯Swin Transformerï¼Ÿ"
    })
    session_id = r1.json()["session_id"]
    
    # ç¬¬äºŒè½®ï¼ˆä¸Šä¸‹æ–‡å»¶ç»­ï¼‰
    r2 = client.post("/api/chat", json={
        "user_id": "test_user",
        "message": "å®ƒå’ŒViTæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ",
        "session_id": session_id
    })
    assert "Swin" in r2.json()["reply"]
```

---

##### C2: Agentå·¥å…·ç³»ç»Ÿ (REQ-C2)

**éœ€æ±‚æè¿°**:  
å®ç°6ä¸ªæ ¸å¿ƒå·¥å…·ï¼Œæ”¯æŒå·¥å…·æ³¨å†Œå’Œè°ƒç”¨ã€‚

**å·¥å…·æ¸…å•**:

1. **GraphQueryTool** - å›¾è°±æŸ¥è¯¢
   ```python
   class GraphQueryTool(BaseTool):
       name = "graph_query"
       description = "åœ¨çŸ¥è¯†å›¾è°±ä¸­æœç´¢ç›¸å…³å­¦æœ¯ä¿¡æ¯"
       
       async def execute(self, input_data):
           # å®ç°å›¾è°±æœç´¢
           pass
   ```

2. **ExternalSearchTool** - å¤–éƒ¨æœç´¢
   ```python
   class ExternalSearchTool(BaseTool):
       name = "external_search"
       description = "åœ¨arXivå’ŒSemantic Scholaræœç´¢æœ€æ–°è®ºæ–‡"
       
       async def execute(self, input_data):
           # è°ƒç”¨arXiv API
           # è‡ªåŠ¨ä¸‹è½½å’Œæ‘„å…¥
           pass
   ```

3. **PDFParseTool** - PDFè§£æ
4. **PaperCompareTool** - è®ºæ–‡å¯¹æ¯”
5. **CommunityQueryTool** - ç¤¾åŒºæŸ¥è¯¢
6. **UserProfileTool** - ç”¨æˆ·ç”»åƒæŸ¥è¯¢

**å·¥å…·æ³¨å†Œå™¨**:
```python
# app/tools/tool_registry.py
tool_registry = ToolRegistry()
tool_registry.register(GraphQueryTool())
tool_registry.register(ExternalSearchTool())
# ...
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] 6ä¸ªå·¥å…·å…¨éƒ¨å®ç°
- [ ] å·¥å…·æ³¨å†Œæœºåˆ¶æ­£å¸¸
- [ ] æ¯ä¸ªå·¥å…·æœ‰å•å…ƒæµ‹è¯•
- [ ] å·¥å…·æ–‡æ¡£å®Œæ•´

---

##### C3: å¯¹è¯å†å² (REQ-C3)

**éœ€æ±‚æè¿°**:  
ä¿å­˜å’ŒæŸ¥è¯¢ç”¨æˆ·çš„èŠå¤©å†å²ã€‚

**APIç«¯ç‚¹**: `GET /api/history/chat/{user_id}`

**å“åº”ç¤ºä¾‹**:
```json
{
  "history": [
    {
      "timestamp": "2024-01-15T10:30:00Z",
      "user_message": "ä»€ä¹ˆæ˜¯Vision Transformerï¼Ÿ",
      "agent_reply": "Vision Transformeræ˜¯...",
      "tools_used": ["graph_query"],
      "satisfaction": 5
    }
  ],
  "total": 45
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®ä¿å­˜èŠå¤©è®°å½•
- [ ] æ”¯æŒåˆ†é¡µæŸ¥è¯¢
- [ ] æ”¯æŒæŒ‰æ—¶é—´ç­›é€‰
- [ ] å“åº”æ—¶é—´ < 500ms

---

### 4.5 æ¨¡å—D: ç”¨æˆ·ç”»åƒæ¨¡å—ï¼ˆå·²åˆ é™¤ï¼‰

**è¯´æ˜**ï¼šä¸ºç®€åŒ–MVPå¼€å‘ï¼Œç”¨æˆ·ç”»åƒå’Œé˜…è¯»å†å²åŠŸèƒ½å»¶ååˆ°v2.0ç‰ˆæœ¬å®ç°ã€‚

---

### 4.6 æ¨¡å—E: æœç´¢ä¸æ¨èæ¨¡å—

**è´Ÿè´£äºº**: @åç«¯å¼€å‘E  
**ä¼˜å…ˆçº§**: P1ï¼ˆé‡è¦åŠŸèƒ½ï¼‰  
**é¢„è®¡å·¥æœŸ**: 2å‘¨

#### åŠŸèƒ½éœ€æ±‚

##### E1: å¤–éƒ¨æœç´¢é›†æˆ (REQ-E1)

**éœ€æ±‚æè¿°**:  
é›†æˆarXivå’ŒSemantic Scholar APIï¼Œæ”¯æŒå¤–éƒ¨è®ºæ–‡æœç´¢ã€‚

**arXivé›†æˆ**:
```python
# app/integrations/arxiv_client.py

class ArxivClient:
    async def search(self, query: str, max_results: int = 10):
        """æœç´¢arXivè®ºæ–‡"""
        papers = arxiv.Search(
            query=query,
            max_results=max_results,
            sort_by=arxiv.SortCriterion.SubmittedDate
        )
        return [self._parse_paper(p) for p in papers.results()]
    
    async def download_pdf(self, arxiv_id: str):
        """ä¸‹è½½PDF"""
        url = f"https://arxiv.org/pdf/{arxiv_id}.pdf"
        # ä¸‹è½½é€»è¾‘
```

**è‡ªåŠ¨æ‘„å…¥æœºåˆ¶**:
```python
async def search_and_ingest(query, user_id):
    # 1. æœç´¢arXiv
    papers = await arxiv_client.search(query)
    
    # 2. è‡ªåŠ¨ä¸‹è½½PDF
    for paper in papers[:5]:  # é™åˆ¶æ•°é‡
        pdf = await arxiv_client.download_pdf(paper.arxiv_id)
        
        # 3. è‡ªåŠ¨æ‘„å…¥å›¾è°±
        await ingest_service.ingest_pdf(
            pdf, 
            metadata=paper,
            group_id="global"  # å†™å…¥å…¨å±€å›¾è°±
        )
```

**APIç«¯ç‚¹**: `POST /api/search/external`

**è¯·æ±‚å‚æ•°**:
```json
{
  "query": "vision transformer 2024",
  "source": "arxiv",  // arxiv | semantic_scholar
  "max_results": 10,
  "auto_ingest": true
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "papers": [
    {
      "arxiv_id": "2401.12345",
      "title": "...",
      "authors": [...],
      "abstract": "...",
      "pdf_url": "...",
      "ingested": true
    }
  ],
  "total_found": 156,
  "ingested_count": 5
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] arXiv APIé›†æˆæ­£å¸¸
- [ ] Semantic Scholar APIé›†æˆæ­£å¸¸
- [ ] è‡ªåŠ¨æ‘„å…¥æœºåˆ¶æ­£ç¡®
- [ ] æœç´¢å“åº”æ—¶é—´ < 5ç§’
- [ ] é”™è¯¯å¤„ç†ï¼ˆAPIé™æµã€ç½‘ç»œé”™è¯¯ï¼‰

---

##### E2: è®ºæ–‡æ¨èï¼ˆå·²åˆ é™¤ï¼‰

**è¯´æ˜**ï¼šä¸ºç®€åŒ–MVPå¼€å‘ï¼Œè®ºæ–‡æ¨èåŠŸèƒ½å»¶ååˆ°v2.0ç‰ˆæœ¬å®ç°ã€‚

---

##### E3: è®ºæ–‡å¯¹æ¯”ï¼ˆå·²åˆ é™¤ï¼‰

**è¯´æ˜**ï¼šä¸ºç®€åŒ–MVPå¼€å‘ï¼Œè®ºæ–‡å¯¹æ¯”åŠŸèƒ½å»¶ååˆ°v2.0ç‰ˆæœ¬å®ç°ã€‚

---

### 4.7 æ¨¡å—F: ç¤¾åŒºç®¡ç†æ¨¡å—

**è´Ÿè´£äºº**: @åç«¯å¼€å‘F  
**ä¼˜å…ˆçº§**: P2ï¼ˆå¢å¼ºåŠŸèƒ½ï¼‰  
**é¢„è®¡å·¥æœŸ**: 1.5å‘¨

#### åŠŸèƒ½éœ€æ±‚

##### F1: ç¤¾åŒºæ£€æµ‹ (REQ-F1)

**éœ€æ±‚æè¿°**:  
ä½¿ç”¨Graphitiçš„`build_communities`åŠŸèƒ½æ£€æµ‹ç ”ç©¶ç¤¾åŒºã€‚

**APIç«¯ç‚¹**: `POST /api/communities/detect`

**è¯·æ±‚å‚æ•°**:
```json
{
  "group_id": "global",  // or "user:123"
  "update_existing": true
}
```

**æŠ€æœ¯å®ç°**:
```python
async def detect_communities(group_id):
    await graphiti.build_communities(
        group_id=group_id,
        update_communities=True
    )
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®è°ƒç”¨Graphiti API
- [ ] æ”¯æŒç”¨æˆ·å’Œå…¨å±€å›¾è°±
- [ ] å¼‚æ­¥ä»»åŠ¡æ‰§è¡Œ
- [ ] è¿›åº¦å¯ç›‘æ§

---

##### F2: ç¤¾åŒºæŸ¥è¯¢ (REQ-F2)

**éœ€æ±‚æè¿°**:  
æŸ¥è¯¢å›¾è°±ä¸­çš„ç ”ç©¶ç¤¾åŒºã€‚

**APIç«¯ç‚¹**: `GET /api/communities`

**å“åº”ç¤ºä¾‹**:
```json
{
  "communities": [
    {
      "community_id": "comm-1",
      "name": "Vision Transformers",
      "summary": "ç ”ç©¶è§†è§‰Transformeræ¶æ„çš„ç¤¾åŒº",
      "node_count": 156,
      "key_papers": ["ViT", "Swin", "DeiT"],
      "key_methods": ["Self-Attention", "Patch Embedding"]
    }
  ]
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®è·å–ç¤¾åŒºåˆ—è¡¨
- [ ] åŒ…å«ç¤¾åŒºæ‘˜è¦
- [ ] å“åº”æ—¶é—´ < 1ç§’

---

### 4.8 æ¨¡å—G: å›¾è°±å¯è§†åŒ–æ¨¡å—

**è´Ÿè´£äºº**: @åç«¯å¼€å‘G  
**ä¼˜å…ˆçº§**: P1ï¼ˆé‡è¦åŠŸèƒ½ï¼‰  
**é¢„è®¡å·¥æœŸ**: 1.5å‘¨

**ä½¿ç”¨åœºæ™¯**:  
ç”¨æˆ·åœ¨å‰ç«¯å›¾è°±å¯è§†åŒ–é¡µé¢å¯ä»¥ï¼š
- æŸ¥çœ‹è‡ªå·±çš„ä¸ªäººçŸ¥è¯†å›¾è°±ï¼ˆèŠ‚ç‚¹å’Œè¾¹çš„å¯è§†åŒ–ï¼‰
- äº¤äº’å¼æ¢ç´¢ï¼šç‚¹å‡»èŠ‚ç‚¹æŸ¥çœ‹è¯¦ç»†å±æ€§
- äº¤äº’å¼æ¢ç´¢ï¼šç‚¹å‡»è¾¹æŸ¥çœ‹å…³ç³»å±æ€§
- ç­›é€‰å’Œè¿‡æ»¤ï¼šæŒ‰å®ä½“ç±»å‹ã€å…³ç³»ç±»å‹ç­›é€‰
- å±€éƒ¨æ¢ç´¢ï¼šå±•å¼€æŸä¸ªèŠ‚ç‚¹çš„é‚»å±…èŠ‚ç‚¹

#### åŠŸèƒ½éœ€æ±‚

##### G1: ç”¨æˆ·å›¾è°±æ•°æ®è·å– (REQ-G1)

**éœ€æ±‚æè¿°**:  
è·å–ç”¨æˆ·ä¸ªäººçŸ¥è¯†å›¾è°±çš„èŠ‚ç‚¹å’Œè¾¹æ•°æ®ï¼Œä¾›å‰ç«¯å¯è§†åŒ–æ¸²æŸ“ã€‚æ”¯æŒåˆ†é¡µã€ç­›é€‰ã€å±€éƒ¨æŸ¥è¯¢ã€‚

**APIç«¯ç‚¹**: `GET /api/graph/visualization/my-graph`

**è¯·æ±‚Header**:
```
Authorization: Bearer <access_token>
```

**è¯·æ±‚å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…éœ€ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|-----|-------|------|
| node_types | string[] | å¦ | all | ç­›é€‰èŠ‚ç‚¹ç±»å‹ï¼Œå¦‚ `["Paper", "Method"]` |
| relation_types | string[] | å¦ | all | ç­›é€‰å…³ç³»ç±»å‹ï¼Œå¦‚ `["PROPOSES", "CITES"]` |
| limit | int | å¦ | 500 | æœ€å¤§è¿”å›èŠ‚ç‚¹æ•°ï¼ˆé˜²æ­¢å¤§å›¾å¡é¡¿ï¼‰ |
| center_node_uuid | string | å¦ | null | ä¸­å¿ƒèŠ‚ç‚¹UUIDï¼ˆè¿”å›å…¶é‚»å±…ï¼‰ |
| max_hops | int | å¦ | 2 | ä»ä¸­å¿ƒèŠ‚ç‚¹çš„æœ€å¤§è·³æ•°ï¼ˆ1-3ï¼‰ |
| include_properties | bool | å¦ | false | æ˜¯å¦åŒ…å«èŠ‚ç‚¹/è¾¹çš„è¯¦ç»†å±æ€§ |

**å“åº”ç¤ºä¾‹**:
```json
{
  "user_id": "user123",
  "graph_data": {
    "nodes": [
      {
        "id": "uuid-1",
        "type": "Paper",
        "name": "Vision Transformer",
        "label": "Vision Transformer",
        "summary": "A paper about ViT...",
        "created_at": "2024-01-15T10:30:00Z",
        "size": 10,
        "color": "#4A90E2"
      },
      {
        "id": "uuid-2",
        "type": "Method",
        "name": "Self-Attention",
        "label": "Self-Attention",
        "summary": "Attention mechanism...",
        "created_at": "2024-01-15T10:35:00Z",
        "size": 8,
        "color": "#E94B3C"
      }
    ],
    "edges": [
      {
        "id": "edge-1",
        "source": "uuid-1",
        "target": "uuid-2",
        "type": "PROPOSES",
        "label": "PROPOSES",
        "created_at": "2024-01-15T10:35:00Z",
        "strength": 0.9
      }
    ]
  },
  "metadata": {
    "total_nodes_in_graph": 1523,
    "returned_nodes": 500,
    "total_edges_in_graph": 3456,
    "returned_edges": 892,
    "has_more": true,
    "generated_at": "2024-01-15T14:30:00Z"
  },
  "node_type_stats": {
    "Paper": 350,
    "Method": 100,
    "Dataset": 30,
    "Task": 20
  }
}
```

**æƒé™æ§åˆ¶**:
- âœ… ç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±çš„ä¸ªäººå›¾è°±ï¼ˆgroup_id = "user:{user_id}"ï¼‰
- âœ… JWT Tokenè®¤è¯å¿…éœ€
- âŒ ä¸å…è®¸æŸ¥çœ‹å…¶ä»–ç”¨æˆ·çš„å›¾è°±

**å¤„ç†é€»è¾‘**:
```python
async def get_my_graph(user_id, filters):
    # 1. ä»Graphitiè·å–ç”¨æˆ·å›¾è°±æ•°æ®
    group_id = f"user:{user_id}"
    
    # 2. å¦‚æœæŒ‡å®šäº†center_nodeï¼Œè·å–å±€éƒ¨å›¾è°±
    if filters.center_node_uuid:
        graph_data = await graphiti.get_node_neighbors(
            node_uuid=filters.center_node_uuid,
            max_hops=filters.max_hops,
            group_id=group_id
        )
    else:
        # è·å–å…¨å›¾ï¼ˆå¸¦é™åˆ¶ï¼‰
        graph_data = await graphiti.get_graph(
            group_id=group_id,
            limit=filters.limit
        )
    
    # 3. åº”ç”¨ç­›é€‰
    filtered_data = apply_filters(graph_data, filters)
    
    # 4. è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼
    return format_for_visualization(filtered_data)
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ”¯æŒJWTè®¤è¯
- [ ] ç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±çš„å›¾è°±
- [ ] æ”¯æŒæŒ‰èŠ‚ç‚¹ç±»å‹ç­›é€‰
- [ ] æ”¯æŒæŒ‰å…³ç³»ç±»å‹ç­›é€‰
- [ ] æ”¯æŒå±€éƒ¨å›¾è°±æŸ¥è¯¢ï¼ˆcenter_node + max_hopsï¼‰
- [ ] å¤§å›¾è°±ï¼ˆ>5000èŠ‚ç‚¹ï¼‰å“åº”æ—¶é—´ < 5ç§’
- [ ] è¿”å›æ•°æ®æ ¼å¼é€‚é…å‰ç«¯å¯è§†åŒ–åº“ï¼ˆå¦‚ EChartsã€D3.jsã€Cytoscape.jsï¼‰
- [ ] é”™è¯¯å¤„ç†å®Œå–„ï¼ˆå›¾è°±ä¸ºç©ºã€èŠ‚ç‚¹ä¸å­˜åœ¨ç­‰ï¼‰

**æµ‹è¯•ç”¨ä¾‹**:
```python
# TC-G1-001: è·å–å®Œæ•´å›¾è°±
def test_get_full_graph():
    response = client.get("/api/graph/visualization/my-graph", 
                         headers=auth_headers)
    assert response.status_code == 200
    assert "nodes" in response.json()["graph_data"]
    assert "edges" in response.json()["graph_data"]

# TC-G1-002: ç­›é€‰ç‰¹å®šç±»å‹
def test_filter_by_node_type():
    response = client.get("/api/graph/visualization/my-graph?node_types=Paper,Method",
                         headers=auth_headers)
    nodes = response.json()["graph_data"]["nodes"]
    assert all(n["type"] in ["Paper", "Method"] for n in nodes)

# TC-G1-003: å±€éƒ¨å›¾è°±æŸ¥è¯¢
def test_get_local_graph():
    response = client.get(
        "/api/graph/visualization/my-graph?center_node_uuid=uuid-1&max_hops=2",
        headers=auth_headers
    )
    assert response.status_code == 200
```

---

##### G2: èŠ‚ç‚¹è¯¦æƒ…æŸ¥è¯¢ (REQ-G2)

**éœ€æ±‚æè¿°**:  
ç”¨æˆ·ç‚¹å‡»å›¾è°±ä¸­çš„èŠ‚ç‚¹æ—¶ï¼Œè·å–è¯¥èŠ‚ç‚¹çš„å®Œæ•´å±æ€§ä¿¡æ¯ã€‚

**APIç«¯ç‚¹**: `GET /api/graph/nodes/{node_uuid}`

**è¯·æ±‚Header**:
```
Authorization: Bearer <access_token>
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "node": {
    "uuid": "uuid-1",
    "type": "Paper",
    "name": "Vision Transformer",
    "properties": {
      "title": "An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale",
      "authors": ["Alexey Dosovitskiy", "Lucas Beyer", "..."],
      "abstract": "While the Transformer architecture has become...",
      "year": 2021,
      "venue": "ICLR",
      "arxiv_id": "2010.11929",
      "doi": "10.48550/arXiv.2010.11929",
      "citations_count": 15000,
      "keywords": ["Vision Transformer", "Self-Attention", "Image Classification"]
    },
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-20T14:20:00Z",
    "group_id": "user:user123"
  },
  "neighbors": {
    "incoming": [
      {
        "uuid": "uuid-5",
        "type": "Paper",
        "name": "DeiT",
        "relation": "CITES",
        "relation_created_at": "2024-01-15T10:35:00Z"
      }
    ],
    "outgoing": [
      {
        "uuid": "uuid-2",
        "type": "Method",
        "name": "Self-Attention",
        "relation": "PROPOSES",
        "relation_created_at": "2024-01-15T10:35:00Z"
      },
      {
        "uuid": "uuid-3",
        "type": "Dataset",
        "name": "ImageNet",
        "relation": "EVALUATES_ON",
        "relation_created_at": "2024-01-15T10:36:00Z"
      }
    ]
  },
  "statistics": {
    "total_neighbors": 15,
    "incoming_edges": 8,
    "outgoing_edges": 7
  }
}
```

**æƒé™æ§åˆ¶**:
- âœ… ç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±å›¾è°±ä¸­çš„èŠ‚ç‚¹
- âœ… JWT Tokenè®¤è¯å¿…éœ€
- âŒ å¦‚æœèŠ‚ç‚¹ä¸å±äºç”¨æˆ·å›¾è°±ï¼Œè¿”å›404

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®è¿”å›èŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§
- [ ] åŒ…å«é‚»å±…èŠ‚ç‚¹åˆ—è¡¨ï¼ˆincoming/outgoingï¼‰
- [ ] æƒé™éªŒè¯æ­£ç¡®
- [ ] å“åº”æ—¶é—´ < 500ms
- [ ] èŠ‚ç‚¹ä¸å­˜åœ¨æ—¶è¿”å›404
- [ ] æ— æƒé™è®¿é—®æ—¶è¿”å›403

---

##### G3: è¾¹è¯¦æƒ…æŸ¥è¯¢ (REQ-G3)

**éœ€æ±‚æè¿°**:  
ç”¨æˆ·ç‚¹å‡»å›¾è°±ä¸­çš„è¾¹æ—¶ï¼Œè·å–è¯¥å…³ç³»çš„å®Œæ•´å±æ€§ä¿¡æ¯ã€‚

**APIç«¯ç‚¹**: `GET /api/graph/edges/{edge_uuid}`

æˆ–è€…ä½¿ç”¨ï¼š`GET /api/graph/edges?source={source_uuid}&target={target_uuid}&type={relation_type}`

**è¯·æ±‚Header**:
```
Authorization: Bearer <access_token>
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "edge": {
    "uuid": "edge-uuid-1",
    "type": "PROPOSES",
    "source_node": {
      "uuid": "uuid-1",
      "type": "Paper",
      "name": "Vision Transformer"
    },
    "target_node": {
      "uuid": "uuid-2",
      "type": "Method",
      "name": "Self-Attention"
    },
    "properties": {
      "confidence": 0.95,
      "source_text": "We propose a pure transformer architecture...",
      "extracted_from": "Method section, paragraph 2",
      "fact": "The Vision Transformer paper proposes the Self-Attention mechanism for image recognition."
    },
    "created_at": "2024-01-15T10:35:00Z",
    "updated_at": "2024-01-15T10:35:00Z",
    "group_id": "user:user123"
  },
  "context": {
    "related_papers": ["uuid-5", "uuid-6"],
    "co_occurrence_count": 3
  }
}
```

**æƒé™æ§åˆ¶**:
- âœ… ç”¨æˆ·åªèƒ½æŸ¥çœ‹è‡ªå·±å›¾è°±ä¸­çš„è¾¹
- âœ… JWT Tokenè®¤è¯å¿…éœ€
- âŒ å¦‚æœè¾¹ä¸å±äºç”¨æˆ·å›¾è°±ï¼Œè¿”å›404

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®è¿”å›è¾¹çš„æ‰€æœ‰å±æ€§
- [ ] åŒ…å«æºèŠ‚ç‚¹å’Œç›®æ ‡èŠ‚ç‚¹ä¿¡æ¯
- [ ] æƒé™éªŒè¯æ­£ç¡®
- [ ] å“åº”æ—¶é—´ < 300ms
- [ ] è¾¹ä¸å­˜åœ¨æ—¶è¿”å›404
- [ ] æ— æƒé™è®¿é—®æ—¶è¿”å›403

---

##### G4: å›¾è°±ç»Ÿè®¡æ¦‚è§ˆ (REQ-G4)

**éœ€æ±‚æè¿°**:  
è·å–ç”¨æˆ·å›¾è°±çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œåœ¨å¯è§†åŒ–é¡µé¢é¡¶éƒ¨æ˜¾ç¤ºã€‚

**APIç«¯ç‚¹**: `GET /api/graph/visualization/stats`

**è¯·æ±‚Header**:
```
Authorization: Bearer <access_token>
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "user_id": "user123",
  "statistics": {
    "total_nodes": 1523,
    "total_edges": 3456,
    "node_types": {
      "Paper": 850,
      "Method": 350,
      "Dataset": 150,
      "Task": 80,
      "Metric": 50,
      "Author": 30,
      "Institution": 10,
      "Concept": 3
    },
    "relation_types": {
      "PROPOSES": 850,
      "EVALUATES_ON": 650,
      "CITES": 1200,
      "SOLVES": 300,
      "IMPROVES_OVER": 200,
      "USES_METRIC": 150,
      "AUTHORED_BY": 80,
      "AFFILIATED_WITH": 20,
      "HAS_CONCEPT": 6
    },
    "last_updated": "2024-01-20T14:30:00Z",
    "graph_created_at": "2024-01-01T08:00:00Z",
    "top_nodes": [
      {
        "uuid": "uuid-1",
        "name": "Vision Transformer",
        "type": "Paper",
        "degree": 25
      },
      {
        "uuid": "uuid-2",
        "name": "Self-Attention",
        "type": "Method",
        "degree": 18
      }
    ]
  }
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®ç»Ÿè®¡èŠ‚ç‚¹å’Œè¾¹çš„æ•°é‡
- [ ] æŒ‰ç±»å‹åˆ†ç±»ç»Ÿè®¡
- [ ] åŒ…å«å›¾è°±æ›´æ–°æ—¶é—´
- [ ] å“åº”æ—¶é—´ < 1ç§’
- [ ] æ”¯æŒç¼“å­˜ï¼ˆæ›´æ–°é¢‘ç‡ï¼š5åˆ†é’Ÿï¼‰

---

##### G5: èŠ‚ç‚¹é‚»å±…å±•å¼€ (REQ-G5)

**éœ€æ±‚æè¿°**:  
åœ¨å›¾è°±å¯è§†åŒ–é¡µé¢ä¸­ï¼Œç”¨æˆ·åŒå‡»æŸä¸ªèŠ‚ç‚¹ï¼Œå±•å¼€å…¶æœªæ˜¾ç¤ºçš„é‚»å±…èŠ‚ç‚¹ã€‚

**APIç«¯ç‚¹**: `GET /api/graph/nodes/{node_uuid}/neighbors`

**è¯·æ±‚Header**:
```
Authorization: Bearer <access_token>
```

**è¯·æ±‚å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…éœ€ | é»˜è®¤å€¼ | è¯´æ˜ |
|-----|------|-----|-------|------|
| direction | string | å¦ | both | incoming / outgoing / both |
| node_types | string[] | å¦ | all | ç­›é€‰é‚»å±…èŠ‚ç‚¹ç±»å‹ |
| relation_types | string[] | å¦ | all | ç­›é€‰å…³ç³»ç±»å‹ |
| limit | int | å¦ | 50 | æœ€å¤§è¿”å›é‚»å±…æ•° |

**å“åº”ç¤ºä¾‹**:
```json
{
  "center_node_uuid": "uuid-1",
  "neighbors": {
    "nodes": [
      {
        "id": "uuid-10",
        "type": "Paper",
        "name": "DeiT",
        "label": "DeiT",
        "summary": "Data-efficient image transformers...",
        "size": 8,
        "color": "#4A90E2"
      },
      {
        "id": "uuid-11",
        "type": "Method",
        "name": "Knowledge Distillation",
        "label": "Knowledge Distillation",
        "summary": "...",
        "size": 6,
        "color": "#E94B3C"
      }
    ],
    "edges": [
      {
        "id": "edge-10",
        "source": "uuid-10",
        "target": "uuid-1",
        "type": "CITES",
        "label": "CITES",
        "strength": 0.8
      },
      {
        "id": "edge-11",
        "source": "uuid-1",
        "target": "uuid-11",
        "type": "PROPOSES",
        "label": "PROPOSES",
        "strength": 0.9
      }
    ]
  },
  "metadata": {
    "total_neighbors": 25,
    "returned_neighbors": 10,
    "has_more": true
  }
}
```

**å‰ç«¯ä½¿ç”¨åœºæ™¯**:
```javascript
// ç”¨æˆ·åŒå‡»èŠ‚ç‚¹æ—¶
async function onNodeDoubleClick(nodeId) {
  const response = await fetch(`/api/graph/nodes/${nodeId}/neighbors?limit=20`, {
    headers: { 'Authorization': `Bearer ${token}` }
  });
  const data = await response.json();
  
  // å°†æ–°èŠ‚ç‚¹å’Œè¾¹æ·»åŠ åˆ°ç°æœ‰å›¾è°±
  graph.addNodes(data.neighbors.nodes);
  graph.addEdges(data.neighbors.edges);
}
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æ­£ç¡®è¿”å›é‚»å±…èŠ‚ç‚¹å’Œè¿æ¥è¾¹
- [ ] æ”¯æŒæ–¹å‘ç­›é€‰ï¼ˆincoming/outgoing/bothï¼‰
- [ ] æ”¯æŒç±»å‹ç­›é€‰
- [ ] æ”¯æŒåˆ†é¡µ
- [ ] å“åº”æ—¶é—´ < 1ç§’
- [ ] ä¸è¿”å›å·²å­˜åœ¨äºå‰ç«¯çš„èŠ‚ç‚¹ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰

---

## 5. æ•°æ®éœ€æ±‚

### 5.1 æ•°æ®éœ€æ±‚æ€»è§ˆ

æ•°æ®æ˜¯AIç§‘ç ”åŠ©æ‰‹ç³»ç»Ÿçš„æ ¸å¿ƒèµ„äº§ï¼ŒåŒ…æ‹¬ï¼š
- **ç§å­æ•°æ®**ï¼šç³»ç»Ÿåˆå§‹åŒ–æ‰€éœ€çš„åŸºç¡€æ•°æ®
- **è¿è¡Œæ—¶æ•°æ®**ï¼šç³»ç»Ÿè¿è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ•°æ®
- **æµ‹è¯•æ•°æ®**ï¼šå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä½¿ç”¨çš„æ•°æ®

| æ•°æ®ç±»å‹ | æ•°é‡çº§ | æ¥æº | ä¼˜å…ˆçº§ |
|---------|--------|------|--------|
| ç§å­è®ºæ–‡ | 1000+ | arXiv/å…¬å¼€æ•°æ®é›† | P0 |
| å®ä½“Schema | 8ç§ | æ‰‹åŠ¨å®šä¹‰ | P0 |
| å…³ç³»Schema | 9ç§ | æ‰‹åŠ¨å®šä¹‰ | P0 |
| æµ‹è¯•è®ºæ–‡PDF | 50+ | æ‰‹åŠ¨æ”¶é›† | P0 |
| ç”¨æˆ·æµ‹è¯•æ•°æ® | 10+ | æ¨¡æ‹Ÿç”Ÿæˆ | P1 |
| æ ‡æ³¨æ•°æ® | 100+ | äººå·¥æ ‡æ³¨ | P1 |

---

### 5.2 åˆå§‹æ•°æ®éœ€æ±‚ï¼ˆç§å­æ•°æ®ï¼‰

#### REQ-D1: ç§å­è®ºæ–‡åº“

**éœ€æ±‚æè¿°**:  
ç³»ç»Ÿä¸Šçº¿å‰éœ€è¦é¢„å…ˆæ„å»ºåŸºç¡€çŸ¥è¯†å›¾è°±ï¼ŒåŒ…å«1000+ç¯‡å­¦æœ¯è®ºæ–‡ã€‚

**æ•°æ®æ¥æº**:
```
1. arXivå…¬å¼€æ•°æ®é›†
   - é¢†åŸŸï¼šComputer Vision, NLP, Machine Learning
   - æ—¶é—´èŒƒå›´ï¼š2020-2024
   - æ•°é‡ï¼š~500ç¯‡

2. ç»å…¸è®ºæ–‡é›†
   - é«˜å¼•ç”¨è®ºæ–‡ï¼ˆ> 500 citationsï¼‰
   - é¢†åŸŸå¥ åŸºæ€§è®ºæ–‡
   - æ•°é‡ï¼š~300ç¯‡

3. æœ€æ–°ä¼šè®®è®ºæ–‡
   - CVPR/ICCV/NeurIPS/ICML 2023-2024
   - æ•°é‡ï¼š~200ç¯‡
```

**æ•°æ®æ ¼å¼**:
```json
{
  "paper_id": "arxiv-2301.12345",
  "title": "Vision Transformer for Dense Prediction",
  "authors": ["Author1", "Author2"],
  "abstract": "...",
  "year": 2023,
  "venue": "CVPR",
  "arxiv_id": "2301.12345",
  "doi": "10.1109/CVPR52729.2023.00001",
  "pdf_url": "https://arxiv.org/pdf/2301.12345.pdf",
  "categories": ["cs.CV", "cs.AI"]
}
```

**æ•°æ®è´¨é‡è¦æ±‚**:
- [ ] PDFå¯æ­£å¸¸è§£æï¼ˆæ— æ‰«æç‰ˆï¼‰
- [ ] å…ƒæ•°æ®å®Œæ•´ï¼ˆè‡³å°‘åŒ…å«æ ‡é¢˜ã€ä½œè€…ã€å¹´ä»½ï¼‰
- [ ] è®ºæ–‡è¯­è¨€ä¸ºè‹±æ–‡
- [ ] æ–‡ä»¶å¤§å° < 50MB
- [ ] æ— æŸåæˆ–ç¼ºå¤±é¡µ

**éªŒæ”¶æ ‡å‡†**:
- [ ] ç§å­è®ºæ–‡ â‰¥ 1000ç¯‡
- [ ] è¦†ç›–3ä¸ªä»¥ä¸Šä¸»è¦AIé¢†åŸŸ
- [ ] PDFè§£ææˆåŠŸç‡ > 95%
- [ ] å®ä½“æŠ½å–è¦†ç›–ç‡ > 80%

---

#### REQ-D2: å®ä½“å’Œå…³ç³»Schema

**éœ€æ±‚æè¿°**:  
å®šä¹‰æ¸…æ™°çš„å®ä½“ç±»å‹å’Œå…³ç³»ç±»å‹Schemaã€‚

**å®ä½“Schemaï¼ˆ8ç§ï¼‰**:

```python
# 1. Paperå®ä½“
class PaperEntity:
    required: [title, abstract, year]
    optional: [arxiv_id, doi, venue, authors, keywords, citations_count]
    
# 2. Methodå®ä½“
class MethodEntity:
    required: [name, description]
    optional: [category, complexity, performance_metrics]

# 3. Datasetå®ä½“
class DatasetEntity:
    required: [name]
    optional: [description, domain, size, format, url]

# 4. Taskå®ä½“
class TaskEntity:
    required: [name]
    optional: [description, category, benchmark_metric]

# 5. Metricå®ä½“
class MetricEntity:
    required: [name]
    optional: [description, formula, range, unit]

# 6. Authorå®ä½“
class AuthorEntity:
    required: [name]
    optional: [affiliation, h_index, research_interests, homepage]

# 7. Institutionå®ä½“
class InstitutionEntity:
    required: [name]
    optional: [country, type, ranking, website]

# 8. Conceptå®ä½“
class ConceptEntity:
    required: [name]
    optional: [description, category, related_concepts]
```

**å…³ç³»Schemaï¼ˆ9ç§ï¼‰**:

| å…³ç³»ç±»å‹ | æºèŠ‚ç‚¹ | ç›®æ ‡èŠ‚ç‚¹ | å¿…éœ€å±æ€§ | å¯é€‰å±æ€§ |
|---------|--------|---------|---------|---------|
| PROPOSES | Paper | Method | - | year, confidence |
| EVALUATES_ON | Paper | Dataset | - | metric, result_value |
| SOLVES | Method | Task | - | performance |
| IMPROVES_OVER | Method | Method | - | improvement_rate |
| CITES | Paper | Paper | - | citation_context |
| USES_METRIC | Paper | Metric | - | result_value |
| AUTHORED_BY | Paper | Author | - | author_order |
| AFFILIATED_WITH | Author | Institution | - | position, start_date |
| HAS_CONCEPT | Paper | Concept | - | relevance_score |

**éªŒæ”¶æ ‡å‡†**:
- [ ] Schemaæ–‡æ¡£å®Œæ•´
- [ ] Pydanticæ¨¡å‹å®šä¹‰å®Œæˆ
- [ ] SchemaéªŒè¯æµ‹è¯•é€šè¿‡
- [ ] ä¸Graphitiå…¼å®¹æ€§éªŒè¯

---

#### REQ-D3: æµ‹è¯•æ•°æ®é›†

**éœ€æ±‚æè¿°**:  
å‡†å¤‡é«˜è´¨é‡çš„æµ‹è¯•æ•°æ®ç”¨äºå¼€å‘å’ŒQAã€‚

**æµ‹è¯•PDFé›†åˆ**:
```
1. æ ‡å‡†è®ºæ–‡ï¼ˆ30ç¯‡ï¼‰
   - ç»“æ„å®Œæ•´ï¼ˆå«Abstractã€Methodã€Experimentsç­‰ï¼‰
   - æ ¼å¼è§„èŒƒï¼ˆåŒæ ã€å•æ å„åŠï¼‰
   - é¡µæ•°é€‚ä¸­ï¼ˆ8-15é¡µï¼‰

2. è¾¹ç•Œæ¡ˆä¾‹ï¼ˆ10ç¯‡ï¼‰
   - è¶…é•¿è®ºæ–‡ï¼ˆ> 30é¡µï¼‰
   - è¶…çŸ­è®ºæ–‡ï¼ˆ< 5é¡µï¼‰
   - ç‰¹æ®Šæ ¼å¼ï¼ˆé¢„å°æœ¬ã€workshopç­‰ï¼‰

3. å¼‚å¸¸æ¡ˆä¾‹ï¼ˆ10ç¯‡ï¼‰
   - å«å¤§é‡å…¬å¼çš„è®ºæ–‡
   - å«å¤§é‡å›¾è¡¨çš„è®ºæ–‡
   - å¤šè¯­è¨€æ··åˆè®ºæ–‡
```

**æµ‹è¯•ç”¨æˆ·æ•°æ®**:
```json
{
  "test_users": [
    {
      "user_id": "test_user_001",
      "profile": {
        "research_direction": "Computer Vision",
        "reading_history": ["paper_001", "paper_002", ...],
        "interests": ["Vision Transformer", "Object Detection"]
      }
    },
    // ... 10ä¸ªæµ‹è¯•ç”¨æˆ·
  ]
}
```

**æ ‡æ³¨æ•°æ®ï¼ˆç”¨äºéªŒè¯ï¼‰**:
```
100ç¯‡è®ºæ–‡çš„äººå·¥æ ‡æ³¨æ•°æ®ï¼š
- å®ä½“æ ‡æ³¨ï¼šæ–¹æ³•ã€æ•°æ®é›†ã€ä»»åŠ¡
- å…³ç³»æ ‡æ³¨ï¼šPROPOSESã€EVALUATES_ONç­‰
- æ‘˜è¦æ ‡æ³¨ï¼šè®ºæ–‡æ ¸å¿ƒå†…å®¹
- ç”¨é€”ï¼šéªŒè¯å®ä½“æŠ½å–å‡†ç¡®ç‡
```

**éªŒæ”¶æ ‡å‡†**:
- [ ] æµ‹è¯•PDF â‰¥ 50ç¯‡
- [ ] æ ‡æ³¨æ•°æ® â‰¥ 100ç¯‡
- [ ] æµ‹è¯•ç”¨æˆ· â‰¥ 10ä¸ª
- [ ] æ ‡æ³¨ä¸€è‡´æ€§ > 90%

---

### 5.3 è¿è¡Œæ—¶æ•°æ®éœ€æ±‚

#### REQ-D4: ç”¨æˆ·æ•°æ®

**ç”¨æˆ·åŸºç¡€æ•°æ®**:
```sql
-- ç”¨æˆ·è¡¨
user_id: VARCHAR(50) PRIMARY KEY
username: VARCHAR(100)
email: VARCHAR(100) UNIQUE
password_hash: VARCHAR(255)
created_at: TIMESTAMP
last_login: TIMESTAMP
```

**ç”¨æˆ·è¡Œä¸ºæ•°æ®**:
```
1. èŠå¤©å†å²
   - å­˜å‚¨æ—¶é•¿ï¼šæ°¸ä¹…
   - é¢„ä¼°é‡ï¼š10ä¸‡æ¡/æœˆ
   - å¢é•¿é€Ÿç‡ï¼šçº¿æ€§

2. é˜…è¯»å†å²
   - å­˜å‚¨æ—¶é•¿ï¼šæ°¸ä¹…
   - é¢„ä¼°é‡ï¼š5ä¸‡æ¡/æœˆ
   - å¢é•¿é€Ÿç‡ï¼šçº¿æ€§

3. ä¸Šä¼ è®ºæ–‡è®°å½•
   - å­˜å‚¨æ—¶é•¿ï¼šæ°¸ä¹…
   - é¢„ä¼°é‡ï¼š1ä¸‡ç¯‡/æœˆ
   - å¢é•¿é€Ÿç‡ï¼šæŒ‡æ•°å¢é•¿
```

**æ•°æ®ä¿ç•™ç­–ç•¥**:
```
- ç”¨æˆ·ç”»åƒï¼šæ°¸ä¹…ä¿ç•™
- èŠå¤©å†å²ï¼šæ°¸ä¹…ä¿ç•™
- ä¸´æ—¶æ–‡ä»¶ï¼ˆPDFä¸Šä¼ ï¼‰ï¼š7å¤©åæ¸…ç†
- æ—¥å¿—æ–‡ä»¶ï¼šä¿ç•™90å¤©
- å¤‡ä»½æ•°æ®ï¼šä¿ç•™180å¤©
```

---

#### REQ-D5: å›¾è°±æ•°æ®

**Neo4jå›¾æ•°æ®åº“**:

**èŠ‚ç‚¹æ•°æ®è§„æ¨¡é¢„ä¼°**:
```
åˆæœŸï¼ˆMonth 1ï¼‰ï¼š
- PaperèŠ‚ç‚¹ï¼š1,000
- MethodèŠ‚ç‚¹ï¼š500
- DatasetèŠ‚ç‚¹ï¼š200
- TaskèŠ‚ç‚¹ï¼š100
- å…¶ä»–èŠ‚ç‚¹ï¼š200
- æ€»è®¡ï¼š~2,000èŠ‚ç‚¹

å¢é•¿æœŸï¼ˆMonth 6ï¼‰ï¼š
- PaperèŠ‚ç‚¹ï¼š10,000
- MethodèŠ‚ç‚¹ï¼š5,000
- DatasetèŠ‚ç‚¹ï¼š1,000
- TaskèŠ‚ç‚¹ï¼š500
- å…¶ä»–èŠ‚ç‚¹ï¼š1,500
- æ€»è®¡ï¼š~18,000èŠ‚ç‚¹

ç¨³å®šæœŸï¼ˆYear 1ï¼‰ï¼š
- PaperèŠ‚ç‚¹ï¼š50,000
- MethodèŠ‚ç‚¹ï¼š20,000
- DatasetèŠ‚ç‚¹ï¼š5,000
- TaskèŠ‚ç‚¹ï¼š2,000
- å…¶ä»–èŠ‚ç‚¹ï¼š8,000
- æ€»è®¡ï¼š~85,000èŠ‚ç‚¹
```

**å…³ç³»æ•°æ®è§„æ¨¡é¢„ä¼°**:
```
å…³ç³»/èŠ‚ç‚¹æ¯”ä¾‹ï¼šçº¦3:1
Year 1 é¢„ä¼°ï¼š~250,000æ¡å…³ç³»
```

**å­˜å‚¨éœ€æ±‚**:
```
æ¯ä¸ªPaperèŠ‚ç‚¹ï¼š~5KBï¼ˆå«å±æ€§å’Œembeddingï¼‰
æ¯ä¸ªå…³ç³»ï¼š~1KB
Year 1 å­˜å‚¨éœ€æ±‚ï¼š
  - èŠ‚ç‚¹ï¼š85,000 Ã— 5KB = 425MB
  - å…³ç³»ï¼š250,000 Ã— 1KB = 250MB
  - ç´¢å¼•å’Œç¼“å­˜ï¼š~2GB
  - æ€»è®¡ï¼š~3GB
```

**å¤‡ä»½ç­–ç•¥**:
```
- å…¨é‡å¤‡ä»½ï¼šæ¯å‘¨æ—¥å‡Œæ™¨
- å¢é‡å¤‡ä»½ï¼šæ¯æ—¥å‡Œæ™¨
- å¤‡ä»½ä¿ç•™ï¼šæœ€è¿‘4å‘¨çš„å…¨é‡ + æœ€è¿‘7å¤©çš„å¢é‡
- å¼‚åœ°å¤‡ä»½ï¼šæ¯æœˆå…¨é‡å¤‡ä»½
```

---

#### REQ-D6: å…³ç³»æ•°æ®åº“æ•°æ®

**MySQLæ•°æ®è§„æ¨¡é¢„ä¼°**:

```sql
-- ç”¨æˆ·è¡¨
users: ~1,000è¡Œ/å¹´

-- èŠå¤©å†å²è¡¨
chat_history: ~120,000è¡Œ/å¹´
  (1000ç”¨æˆ· Ã— 10å¯¹è¯/æœˆ Ã— 12æœˆ)

-- é˜…è¯»å†å²è¡¨
reading_history: ~60,000è¡Œ/å¹´
  (1000ç”¨æˆ· Ã— 5ç¯‡/æœˆ Ã— 12æœˆ)

-- ç”¨æˆ·ç”»åƒè¡¨
user_profiles: ~1,000è¡Œ/å¹´

æ€»å­˜å‚¨éœ€æ±‚ï¼š
  - æ•°æ®ï¼š~500MB/å¹´
  - ç´¢å¼•ï¼š~200MB/å¹´
  - æ€»è®¡ï¼š~1GB/å¹´
```

---

### 5.4 æ•°æ®è´¨é‡æ ‡å‡†

#### REQ-D7: æ•°æ®è´¨é‡è¦æ±‚

**å®Œæ•´æ€§è¦æ±‚**:
```
Paperå®ä½“ï¼š
- å¿…å¡«å­—æ®µå®Œæ•´ç‡ï¼š100%
- å¯é€‰å­—æ®µå®Œæ•´ç‡ï¼š> 60%

Methodå®ä½“ï¼š
- åç§°å”¯ä¸€æ€§ï¼š100%
- æè¿°å®Œæ•´ç‡ï¼š> 80%

å…³ç³»ï¼š
- æœ‰æ•ˆå…³ç³»ï¼ˆæºå’Œç›®æ ‡èŠ‚ç‚¹å­˜åœ¨ï¼‰ï¼š100%
- å…³ç³»å±æ€§å®Œæ•´ç‡ï¼š> 70%
```

**å‡†ç¡®æ€§è¦æ±‚**:
```
å®ä½“æŠ½å–ï¼š
- å‡†ç¡®ç‡ï¼š> 85%
- å¬å›ç‡ï¼š> 80%
- F1åˆ†æ•°ï¼š> 82%

å…³ç³»æŠ½å–ï¼š
- å‡†ç¡®ç‡ï¼š> 75%
- å¬å›ç‡ï¼š> 70%
- F1åˆ†æ•°ï¼š> 72%

å…ƒæ•°æ®å‡†ç¡®æ€§ï¼š
- è®ºæ–‡æ ‡é¢˜åŒ¹é…ï¼š> 95%
- ä½œè€…è¯†åˆ«å‡†ç¡®ç‡ï¼š> 90%
- å¹´ä»½å‡†ç¡®ç‡ï¼š100%
```

**ä¸€è‡´æ€§è¦æ±‚**:
```
å®ä½“å½’ä¸€åŒ–ï¼š
- é‡å¤å®ä½“æ£€æµ‹ç‡ï¼š> 90%
- è‡ªåŠ¨åˆå¹¶å‡†ç¡®ç‡ï¼š> 85%

æ•°æ®æ ¼å¼ï¼š
- æ—¥æœŸæ ¼å¼ï¼šISO 8601
- æ–‡æœ¬ç¼–ç ï¼šUTF-8
- æ•°å€¼ç²¾åº¦ï¼šå°æ•°ç‚¹å2ä½
```

**æ—¶æ•ˆæ€§è¦æ±‚**:
```
æ•°æ®æ›´æ–°ï¼š
- ç”¨æˆ·ç”»åƒæ›´æ–°ï¼šå®æ—¶
- å›¾è°±æ•°æ®æ›´æ–°ï¼š< 5åˆ†é’Ÿ
- æ¨èç»“æœæ›´æ–°ï¼š< 1å°æ—¶
- ç¤¾åŒºé‡å»ºï¼šæ¯å‘¨
```

---

### 5.5 æ•°æ®è·å–ä¸å¤„ç†

#### REQ-D8: æ•°æ®è·å–æµç¨‹

**ç§å­æ•°æ®è·å–**:
```python
# 1. arXivæ•°æ®è·å–
def fetch_arxiv_papers(categories, start_date, end_date, limit):
    """
    ä»arXiv APIæ‰¹é‡è·å–è®ºæ–‡
    
    å‚æ•°ï¼š
    - categories: ['cs.CV', 'cs.AI', 'cs.LG']
    - start_date: '2020-01-01'
    - end_date: '2024-12-31'
    - limit: 1000
    """
    papers = []
    for category in categories:
        query = f"cat:{category} AND submittedDate:[{start_date} TO {end_date}]"
        results = arxiv.Search(query=query, max_results=limit)
        papers.extend(process_arxiv_results(results))
    return papers

# 2. è®ºæ–‡PDFä¸‹è½½
def download_papers(papers):
    """æ‰¹é‡ä¸‹è½½è®ºæ–‡PDF"""
    for paper in papers:
        pdf = download_pdf(paper.pdf_url)
        save_to_storage(pdf, f"seeds/{paper.arxiv_id}.pdf")

# 3. æ‰¹é‡æ‘„å…¥
def batch_ingest(pdf_files):
    """æ‰¹é‡æ‘„å…¥åˆ°å›¾è°±"""
    for pdf in pdf_files:
        task = ingest_pdf_task.delay(pdf)
        monitor_task_status(task.id)
```

**æ•°æ®é¢„å¤„ç†Pipeline**:
```
åŸå§‹PDF
  â†“
æ–‡æœ¬æå–ï¼ˆPyMuPDFï¼‰
  â†“
æ–‡æœ¬æ¸…æ´—
  - ç§»é™¤é¡µçœ‰é¡µè„š
  - ä¿®å¤æ–­è¡Œ
  - ç»Ÿä¸€æ ¼å¼
  â†“
ç« èŠ‚è¯†åˆ«
  - Abstract
  - Introduction
  - Method
  - Experiments
  - Conclusion
  â†“
åˆ†å—ï¼ˆChunkingï¼‰
  - æ¯ä¸ªsectionä½œä¸ºä¸€ä¸ªchunk
  - é•¿sectionè¿›ä¸€æ­¥åˆ†å‰²ï¼ˆ< 2000 tokensï¼‰
  â†“
è´¨é‡æ£€æŸ¥
  - æ–‡æœ¬å®Œæ•´æ€§
  - æ ¼å¼è§„èŒƒæ€§
  - å¯è¯»æ€§è¯„åˆ†
  â†“
å­˜å‚¨åˆ°æš‚å­˜åŒº
```

**æ•°æ®éªŒè¯Pipeline**:
```
å®ä½“æŠ½å–ç»“æœ
  â†“
æ ¼å¼éªŒè¯
  - Schema compliance
  - å¿…å¡«å­—æ®µæ£€æŸ¥
  â†“
è¯­ä¹‰éªŒè¯
  - å®ä½“ç±»å‹åˆç†æ€§
  - å…³ç³»é€»è¾‘ä¸€è‡´æ€§
  â†“
å»é‡æ£€æŸ¥
  - å®ä½“åç§°ç›¸ä¼¼åº¦
  - è‡ªåŠ¨åˆå¹¶å»ºè®®
  â†“
äººå·¥å®¡æ ¸ï¼ˆæŠ½æ ·10%ï¼‰
  â†“
å†™å…¥å›¾è°±
```

---

### 5.6 æ•°æ®å®‰å…¨ä¸éšç§

#### REQ-D9: æ•°æ®å®‰å…¨è¦æ±‚

**æ•°æ®åˆ†ç±»**:
```
Level 1 - å…¬å¼€æ•°æ®ï¼š
  - è®ºæ–‡å…ƒæ•°æ®
  - å®ä½“å’Œå…³ç³»
  - å…¬å¼€çš„å›¾è°±æ•°æ®
  - ä¿æŠ¤æªæ–½ï¼šæ— éœ€åŠ å¯†

Level 2 - ç”¨æˆ·æ•°æ®ï¼š
  - ç”¨æˆ·ç”»åƒ
  - é˜…è¯»å†å²
  - èŠå¤©å†å²
  - ä¿æŠ¤æªæ–½ï¼šä¼ è¾“åŠ å¯† + è®¿é—®æ§åˆ¶

Level 3 - æ•æ„Ÿæ•°æ®ï¼š
  - ç”¨æˆ·å‡­è¯ï¼ˆå¯†ç ï¼‰
  - ä¸ªäººèº«ä»½ä¿¡æ¯
  - ä¿æŠ¤æªæ–½ï¼šåŠ å¯†å­˜å‚¨ + ä¸¥æ ¼è®¿é—®æ§åˆ¶
```

**åŠ å¯†è¦æ±‚**:
```
ä¼ è¾“åŠ å¯†ï¼š
  - HTTPS/TLS 1.3
  - æœ€å°å¯†é’¥é•¿åº¦ï¼š2048 bits

å­˜å‚¨åŠ å¯†ï¼š
  - å¯†ç ï¼šbcrypt (cost factor: 12)
  - æ•æ„Ÿå­—æ®µï¼šAES-256
  - æ•°æ®åº“ï¼šé€æ˜æ•°æ®åŠ å¯†ï¼ˆTDEï¼‰
```

**è®¿é—®æ§åˆ¶**:
```
æ•°æ®åº“è®¿é—®ï¼š
  - æœ€å°æƒé™åŸåˆ™
  - åº”ç”¨è´¦å·ï¼šè¯»å†™æƒé™
  - å¤‡ä»½è´¦å·ï¼šåªè¯»æƒé™
  - ç®¡ç†è´¦å·ï¼šå…¨éƒ¨æƒé™ï¼ˆå®¡è®¡æ—¥å¿—ï¼‰

APIè®¿é—®ï¼š
  - JWT Tokenè®¤è¯
  - ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
  - ç®¡ç†å‘˜å¯è®¿é—®æ‰€æœ‰æ•°æ®ï¼ˆå®¡è®¡æ—¥å¿—ï¼‰
```

**éšç§ä¿æŠ¤**:
```
æ•°æ®åŒ¿ååŒ–ï¼š
  - æµ‹è¯•ç¯å¢ƒä½¿ç”¨è„±æ•æ•°æ®
  - ç”¨æˆ·IDä¸å¯é€†å“ˆå¸Œ
  - æ—¥å¿—ä¸­ä¸è®°å½•æ•æ„Ÿä¿¡æ¯

æ•°æ®åˆ é™¤ï¼š
  - ç”¨æˆ·å¯åˆ é™¤è‡ªå·±çš„æ•°æ®
  - åˆ é™¤å30å¤©å†…å¯æ¢å¤
  - 30å¤©åç‰©ç†åˆ é™¤
```

---

### 5.7 æ•°æ®æ²»ç†

#### REQ-D10: æ•°æ®ç®¡ç†è§„èŒƒ

**æ•°æ®æ‰€æœ‰æƒ**:
```
è®ºæ–‡æ•°æ®ï¼š
  - æ¥æºï¼šå…¬å¼€æ•°æ®æº
  - ç‰ˆæƒï¼šéµå¾ªåŸå§‹è®ºæ–‡ç‰ˆæƒ
  - ä½¿ç”¨ï¼šå­¦æœ¯ç ”ç©¶ç”¨é€”

ç”¨æˆ·æ•°æ®ï¼š
  - æ‰€æœ‰æƒï¼šç”¨æˆ·æœ¬äºº
  - ä½¿ç”¨ï¼šç»ç”¨æˆ·åŒæ„
  - å¯¼å‡ºï¼šç”¨æˆ·å¯å¯¼å‡ºè‡ªå·±çš„æ•°æ®
```

**æ•°æ®è´¨é‡ç›‘æ§**:
```
æ¯æ—¥ç›‘æ§æŒ‡æ ‡ï¼š
  - æ–°å¢è®ºæ–‡æ•°
  - å®ä½“æŠ½å–æˆåŠŸç‡
  - æ•°æ®å®Œæ•´æ€§
  - å¼‚å¸¸æ•°æ®æ£€æµ‹

æ¯å‘¨æŠ¥å‘Šï¼š
  - æ•°æ®è´¨é‡è¯„åˆ†
  - æ•°æ®å¢é•¿è¶‹åŠ¿
  - å¼‚å¸¸é—®é¢˜æ±‡æ€»
  - æ”¹è¿›å»ºè®®
```

**æ•°æ®ç‰ˆæœ¬ç®¡ç†**:
```
Schemaç‰ˆæœ¬ï¼š
  - ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬ï¼ˆSemantic Versioningï¼‰
  - ç‰ˆæœ¬å˜æ›´éœ€è¦è¿ç§»è„šæœ¬
  - ä¿æŒå‘åå…¼å®¹æ€§

å›¾è°±å¿«ç…§ï¼š
  - æ¯æœˆåˆ›å»ºå¿«ç…§
  - å¿«ç…§ä¿ç•™6ä¸ªæœˆ
  - ç”¨äºå›æ»šå’Œå®¡è®¡
```

**æ•°æ®æ¸…ç†ç­–ç•¥**:
```
å®šæœŸæ¸…ç†ï¼š
  - ä¸´æ—¶æ–‡ä»¶ï¼š7å¤©
  - å¤±è´¥ä»»åŠ¡è®°å½•ï¼š30å¤©
  - ç³»ç»Ÿæ—¥å¿—ï¼š90å¤©
  - ç”¨æˆ·åˆ é™¤æ•°æ®ï¼š30å¤©è½¯åˆ é™¤ + ç‰©ç†åˆ é™¤

æ•°æ®å½’æ¡£ï¼š
  - 1å¹´ä»¥ä¸Šçš„èŠå¤©å†å²ï¼šå½’æ¡£åˆ°å†·å­˜å‚¨
  - è®¿é—®é¢‘ç‡ < 1æ¬¡/æœˆçš„è®ºæ–‡ï¼šå½’æ¡£
  - å½’æ¡£æ•°æ®æŸ¥è¯¢å»¶è¿Ÿï¼š< 5ç§’
```

---

### 5.8 æ•°æ®éœ€æ±‚ä¼˜å…ˆçº§

| æ•°æ®éœ€æ±‚ID | éœ€æ±‚åç§° | ä¼˜å…ˆçº§ | è´£ä»»äºº | ä¾èµ– | äº¤ä»˜æ—¶é—´ |
|-----------|---------|--------|--------|------|---------|
| REQ-D1 | ç§å­è®ºæ–‡åº“ | P0 | @Dev-B | - | Sprint 1 |
| REQ-D2 | Schemaå®šä¹‰ | P0 | @Dev-B | - | Sprint 1 |
| REQ-D3 | æµ‹è¯•æ•°æ®é›† | P0 | @QA | REQ-D1 | Sprint 1 |
| REQ-D4 | ç”¨æˆ·æ•°æ®ç»“æ„ | P0 | @Dev-D | - | Sprint 1 |
| REQ-D5 | å›¾è°±æ•°æ®è§„åˆ’ | P0 | @Dev-B | REQ-D2 | Sprint 1 |
| REQ-D6 | å…³ç³»DBè®¾è®¡ | P0 | @Dev-D | - | Sprint 1 |
| REQ-D7 | æ•°æ®è´¨é‡æ ‡å‡† | P1 | @QA | REQ-D3 | Sprint 2 |
| REQ-D8 | æ•°æ®è·å–æµç¨‹ | P0 | @Dev-E | REQ-D1 | Sprint 2 |
| REQ-D9 | æ•°æ®å®‰å…¨è§„èŒƒ | P1 | @DevOps | - | Sprint 2 |
| REQ-D10 | æ•°æ®æ²»ç†è§„èŒƒ | P2 | @PM | - | Sprint 3 |

---

## 6. éåŠŸèƒ½éœ€æ±‚

### 6.1 æ€§èƒ½éœ€æ±‚

| æŒ‡æ ‡ | è¦æ±‚ | æµ‹è¯•æ–¹æ³• |
|-----|------|---------|
| APIå“åº”æ—¶é—´ | P95 < 3ç§’ | å‹åŠ›æµ‹è¯• |
| å›¾è°±æœç´¢ | < 2ç§’ | æ€§èƒ½æµ‹è¯• |
| PDFè§£æ | < 2åˆ†é’Ÿ | è®¡æ—¶æµ‹è¯• |
| å¹¶å‘ç”¨æˆ· | æ”¯æŒ100+ | å¹¶å‘æµ‹è¯• |
| æ•°æ®åº“æŸ¥è¯¢ | < 500ms | æ…¢æŸ¥è¯¢ç›‘æ§ |

### 6.2 å¯é æ€§éœ€æ±‚

- **ç³»ç»Ÿå¯ç”¨æ€§**: 99.5%
- **æ•°æ®å¤‡ä»½**: æ¯æ—¥å¢é‡å¤‡ä»½
- **é”™è¯¯å¤„ç†**: æ‰€æœ‰APIéƒ½æœ‰é”™è¯¯å¤„ç†
- **æ—¥å¿—è®°å½•**: å®Œæ•´çš„æ“ä½œæ—¥å¿—

### 6.3 å®‰å…¨éœ€æ±‚

- **APIè®¤è¯**: JWT Tokenï¼ˆæš‚ç”¨mockï¼‰
- **æ•°æ®åŠ å¯†**: HTTPSä¼ è¾“
- **è¾“å…¥éªŒè¯**: PydanticéªŒè¯
- **SQLæ³¨å…¥é˜²æŠ¤**: ORMå‚æ•°åŒ–æŸ¥è¯¢

### 6.4 å¯æ‰©å±•æ€§éœ€æ±‚

- **æ¨¡å—åŒ–è®¾è®¡**: å„æ¨¡å—ç‹¬ç«‹
- **æœåŠ¡è§£è€¦**: å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—
- **æ°´å¹³æ‰©å±•**: æ”¯æŒå¤šå®ä¾‹éƒ¨ç½²
- **é…ç½®å¤–éƒ¨åŒ–**: ç¯å¢ƒå˜é‡ç®¡ç†

### 6.5 å¯ç»´æŠ¤æ€§éœ€æ±‚

- **ä»£ç è§„èŒƒ**: PEP8
- **æ³¨é‡Šè¦†ç›–**: > 60%
- **å•å…ƒæµ‹è¯•**: è¦†ç›–ç‡ > 70%
- **APIæ–‡æ¡£**: OpenAPIè‡ªåŠ¨ç”Ÿæˆ

---

## 7. æŠ€æœ¯æ¶æ„

### 7.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯UI    â”‚
â”‚  (React)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ HTTP/WebSocket
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      FastAPI Backend            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API Layer (routes/)            â”‚
â”‚  Service Layer (services/)      â”‚
â”‚  Model Layer (models/)          â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                  â”‚
       â†“                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Graphiti   â”‚    â”‚   Celery    â”‚
â”‚  + Neo4j    â”‚    â”‚   Worker    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   Redis     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ |
|-----|---------|------|
| Webæ¡†æ¶ | FastAPI | 0.109+ |
| å›¾è°±å¼•æ“ | Graphiti + Neo4j | Latest |
| LLM | OpenAI GPT-4 | gpt-4-turbo |
| å‘é‡åŒ– | Sentence-Transformers | 2.2+ |
| ä»»åŠ¡é˜Ÿåˆ— | Celery + Redis | 5.3+ |
| æ•°æ®åº“ | PostgreSQL | 14+ |
| PDFè§£æ | PyMuPDF | 1.23+ |
| å®¹å™¨åŒ– | Docker | 20.10+ |

### 7.3 æ•°æ®åº“è®¾è®¡

**Neo4jï¼ˆå›¾æ•°æ®åº“ï¼‰**:
- èŠ‚ç‚¹: Paper, Method, Dataset, Task, Metric, Author, Institution, Concept
- å…³ç³»: PROPOSES, EVALUATES_ON, SOLVES, CITES, etc.
- ä½¿ç”¨Graphitiç®¡ç†

**MySQLï¼ˆå…³ç³»æ•°æ®åº“ï¼‰**:
```sql
-- ç”¨æˆ·è¡¨
CREATE TABLE users (
    user_id VARCHAR(50) PRIMARY KEY,
    username VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login TIMESTAMP NULL,
    is_active BOOLEAN DEFAULT TRUE,
    failed_login_attempts INT DEFAULT 0,
    locked_until TIMESTAMP NULL,
    INDEX idx_email (email),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- èŠå¤©å†å²è¡¨
CREATE TABLE chat_history (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    session_id VARCHAR(100),
    message TEXT NOT NULL,
    response TEXT NOT NULL,
    tools_used JSON,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_user_time (user_id, timestamp DESC),
    INDEX idx_session (session_id),
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- é˜…è¯»å†å²è¡¨
CREATE TABLE reading_history (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id VARCHAR(50) NOT NULL,
    paper_id VARCHAR(100) NOT NULL,
    read_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    duration_seconds INT DEFAULT 0,
    completed BOOLEAN DEFAULT FALSE,
    INDEX idx_user_read (user_id, read_at DESC),
    INDEX idx_paper (paper_id),
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ç”¨æˆ·ç”»åƒè¡¨
CREATE TABLE user_profiles (
    user_id VARCHAR(50) PRIMARY KEY,
    research_direction TEXT,
    interests JSON,
    expertise_level VARCHAR(20),
    reading_count INT DEFAULT 0,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

**æ•°æ®åº“è¿ç§»ç®¡ç†ï¼ˆAlembicï¼‰**:

Alembicé…ç½®æ–‡ä»¶ `alembic.ini`:
```ini
[alembic]
script_location = alembic
sqlalchemy.url = mysql+pymysql://user:password@localhost/research_agent

[loggers]
keys = root,sqlalchemy,alembic

[handlers]
keys = console

[formatters]
keys = generic
```

è¿ç§»è„šæœ¬ç¤ºä¾‹ `alembic/versions/001_create_users.py`:
```python
"""create users table

Revision ID: 001
Revises: 
Create Date: 2024-01-15 10:00:00

"""
from alembic import op
import sqlalchemy as sa

def upgrade():
    op.create_table(
        'users',
        sa.Column('user_id', sa.String(50), primary_key=True),
        sa.Column('username', sa.String(100), nullable=False),
        sa.Column('email', sa.String(100), nullable=False, unique=True),
        sa.Column('password_hash', sa.String(255), nullable=False),
        sa.Column('created_at', sa.TIMESTAMP, server_default=sa.func.current_timestamp()),
        sa.Column('last_login', sa.TIMESTAMP, nullable=True),
        sa.Column('is_active', sa.Boolean, default=True),
        mysql_engine='InnoDB',
        mysql_charset='utf8mb4',
        mysql_collate='utf8mb4_unicode_ci'
    )
    
    op.create_index('idx_email', 'users', ['email'])

def downgrade():
    op.drop_index('idx_email', 'users')
    op.drop_table('users')
```

**Alembicå¸¸ç”¨å‘½ä»¤**:
```bash
# åˆå§‹åŒ–Alembic
alembic init alembic

# åˆ›å»ºè¿ç§»è„šæœ¬
alembic revision -m "create users table"

# è‡ªåŠ¨ç”Ÿæˆè¿ç§»ï¼ˆæ£€æµ‹æ¨¡å‹å˜åŒ–ï¼‰
alembic revision --autogenerate -m "add new columns"

# æ‰§è¡Œè¿ç§»ï¼ˆå‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼‰
alembic upgrade head

# å›æ»šè¿ç§»
alembic downgrade -1

# æŸ¥çœ‹è¿ç§»å†å²
alembic history

# æŸ¥çœ‹å½“å‰ç‰ˆæœ¬
alembic current
```

---

## 8. å¼€å‘åˆ†å·¥

### 8.1 å›¢é˜Ÿç»„æˆ

| è§’è‰² | å§“å | èŒè´£ | è´Ÿè´£æ¨¡å— |
|-----|------|------|---------|
| é¡¹ç›®ç»ç† | [PM] | æ•´ä½“åè°ƒã€è¿›åº¦ç®¡ç† | å…¨éƒ¨ |
| åç«¯å¼€å‘A | [Dev-A] | è®ºæ–‡ç®¡ç†æ¨¡å— | Module A |
| åç«¯å¼€å‘B | [Dev-B] | çŸ¥è¯†å›¾è°±æ¨¡å— | Module B |
| åç«¯å¼€å‘C | [Dev-C] | æ™ºèƒ½é—®ç­”æ¨¡å— | Module C |
| åç«¯å¼€å‘D | [Dev-D] | ç”¨æˆ·ç”»åƒæ¨¡å— | Module D |
| åç«¯å¼€å‘E | [Dev-E] | æœç´¢ä¸æ¨è | Module E |
| åç«¯å¼€å‘F | [Dev-F] | ç¤¾åŒºç®¡ç† | Module F |
| åç«¯å¼€å‘G | [Dev-G] | **å›¾è°±å¯è§†åŒ–æ¨¡å—**ï¼ˆäº¤äº’å¼ï¼‰ | Module G |
| åç«¯å¼€å‘H | [Dev-H] | ç”¨æˆ·è®¤è¯æ¨¡å— | Module H |
| æµ‹è¯•å·¥ç¨‹å¸ˆ | [QA] | æµ‹è¯•ã€è´¨é‡ä¿è¯ | å…¨éƒ¨ |
| DevOps | [Ops] | éƒ¨ç½²ã€è¿ç»´ | åŸºç¡€è®¾æ–½ |

### 8.2 æ¨¡å—ä¾èµ–å…³ç³»

```
Module H (ç”¨æˆ·è®¤è¯)      â† åŸºç¡€æ¨¡å—ï¼Œæœ€å…ˆå¼€å‘ï¼ˆWeek 1ï¼‰
    â†“
Module B (å›¾è°±)          â† åŸºç¡€æ¨¡å—ï¼ˆWeek 1-2ï¼‰
    â†“
Module A (è®ºæ–‡ç®¡ç†)      â† ä¾èµ–Module H, B
    â†“
Module C (æ™ºèƒ½é—®ç­”)      â† ä¾èµ–Module A, B
    â†“
Module D (ç”¨æˆ·ç”»åƒ)      â† ä¾èµ–Module C, H
Module E (æœç´¢æ¨è)      â† ä¾èµ–Module A, B, D
    â†“
Module F (ç¤¾åŒºç®¡ç†)      â† ä¾èµ–Module B
Module G (å¯è§†åŒ–)        â† ä¾èµ–Module B
```

**å¼€å‘é¡ºåºå»ºè®®**:
1. Week 1: Module H (ç”¨æˆ·è®¤è¯) + æ•°æ®åº“åˆå§‹åŒ–
2. Week 1-2: Module B (å›¾è°±åŸºç¡€ï¼Œå¯ä¸Héƒ¨åˆ†å¹¶è¡Œ)
3. Week 3-4: Module A (è®ºæ–‡ç®¡ç†)
4. Week 5-7: Module C (æ™ºèƒ½é—®ç­”)
5. Week 6-7: Module D (ç”¨æˆ·ç”»åƒï¼Œå¯å¹¶è¡Œ)
6. Week 7-8: Module E (æœç´¢æ¨è)
7. Week 8: Module F, G (ç¤¾åŒºã€å¯è§†åŒ–ï¼Œå¯å¹¶è¡Œ)

### 8.3 æ²Ÿé€šæœºåˆ¶

- **æ¯æ—¥ç«™ä¼š**: æ—©ä¸Š10:00ï¼Œ15åˆ†é’Ÿï¼ŒåŒæ­¥è¿›åº¦å’Œé—®é¢˜
- **å‘¨ä¼š**: æ¯å‘¨äº”ä¸‹åˆï¼ŒReviewæœ¬å‘¨è¿›åº¦ï¼Œè§„åˆ’ä¸‹å‘¨ä»»åŠ¡
- **æŠ€æœ¯è¯„å®¡**: å…³é”®åŠŸèƒ½å¼€å‘å‰ï¼Œå›¢é˜Ÿè¯„å®¡è®¾è®¡æ–¹æ¡ˆ
- **ä»£ç å®¡æŸ¥**: æ‰€æœ‰PRéœ€è‡³å°‘1äººReview
- **æ–‡æ¡£åŒæ­¥**: ä½¿ç”¨Confluenceç»´æŠ¤æŠ€æœ¯æ–‡æ¡£

---

## 9. é‡Œç¨‹ç¢‘ä¸äº¤ä»˜

### 9.1 è¿­ä»£è®¡åˆ’

#### Sprint 1: åŸºç¡€æ¶æ„ï¼ˆWeek 1-2ï¼‰

**ç›®æ ‡**: æ­å»ºåŸºç¡€æ¶æ„ï¼Œå®Œæˆç”¨æˆ·è®¤è¯å’Œå›¾è°±æ¨¡å—

**äº¤ä»˜ç‰©**:
- [ ] Dockerç¯å¢ƒæ­å»ºå®Œæˆï¼ˆMySQL + Neo4j + Redisï¼‰
- [ ] Alembicæ•°æ®åº“è¿ç§»é…ç½®å®Œæˆ
- [ ] ç”¨æˆ·è®¤è¯æ¨¡å—å®ç°ï¼ˆREQ-H1~H7ï¼‰
- [ ] JWTè®¤è¯ä¸­é—´ä»¶å®ç°
- [ ] Schemaå®šä¹‰å®Œæˆï¼ˆREQ-B4ï¼‰
- [ ] å›¾è°±æœç´¢å®ç°ï¼ˆREQ-B1, B2, B3ï¼‰
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 60%

**Demoå†…å®¹**:
- æ¼”ç¤ºç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- æ¼”ç¤ºJWT Tokenè®¤è¯
- æ¼”ç¤ºå›¾è°±æœç´¢APIï¼ˆéœ€ç™»å½•ï¼‰
- æ¼”ç¤ºèŠ‚ç‚¹æŸ¥è¯¢API

---

#### Sprint 2: è®ºæ–‡ç®¡ç†ï¼ˆWeek 3-4ï¼‰

**ç›®æ ‡**: å®ç°è®ºæ–‡ä¸Šä¼ ã€è§£æã€æ‘„å…¥

**äº¤ä»˜ç‰©**:
- [ ] PDFä¸Šä¼ APIï¼ˆREQ-A1ï¼‰
- [ ] PDFè§£æå™¨å®ç°
- [ ] å®ä½“æŠ½å–æœåŠ¡å®ç°
- [ ] è®ºæ–‡æŸ¥è¯¢APIï¼ˆREQ-A2, A3ï¼‰
- [ ] å¼‚æ­¥ä»»åŠ¡æ­£å¸¸è¿è¡Œ

**Demoå†…å®¹**:
- æ¼”ç¤ºä¸Šä¼ è®ºæ–‡å¹¶è‡ªåŠ¨æ„å»ºå›¾è°±
- æ¼”ç¤ºè®ºæ–‡æŸ¥è¯¢

---

#### Sprint 3: æ™ºèƒ½é—®ç­”ï¼ˆWeek 5-7ï¼‰

**ç›®æ ‡**: å®ç°Agentå¯¹è¯å’Œå·¥å…·ç³»ç»Ÿ

**äº¤ä»˜ç‰©**:
- [ ] 6ä¸ªå·¥å…·å…¨éƒ¨å®ç°ï¼ˆREQ-C2ï¼‰
- [ ] Agentå¯¹è¯å®ç°ï¼ˆREQ-C1ï¼‰
- [ ] å¯¹è¯å†å²å®ç°ï¼ˆREQ-C3ï¼‰
- [ ] ç«¯åˆ°ç«¯å¯¹è¯æµ‹è¯•é€šè¿‡

**Demoå†…å®¹**:
- æ¼”ç¤ºå®Œæ•´å¯¹è¯æµç¨‹
- æ¼”ç¤ºå·¥å…·è°ƒç”¨
- æ¼”ç¤ºå¤–éƒ¨æœç´¢fallback

---

#### Sprint 4: å¤–éƒ¨æœç´¢ä¸æ‰©å±•åŠŸèƒ½ï¼ˆWeek 6-8ï¼‰

**ç›®æ ‡**: å®ç°å¤–éƒ¨æœç´¢ã€ç¤¾åŒºç®¡ç†å’Œå¯è§†åŒ–

**äº¤ä»˜ç‰©**:
- [ ] å¤–éƒ¨æœç´¢é›†æˆï¼ˆREQ-E1ï¼‰
- [ ] ç¤¾åŒºç®¡ç†ï¼ˆREQ-F1, F2ï¼‰
- [ ] å¯è§†åŒ–æ”¯æŒï¼ˆREQ-G1ï¼‰

**Demoå†…å®¹**:
- æ¼”ç¤ºå¤–éƒ¨æœç´¢å’Œè‡ªåŠ¨æ‘„å…¥
- æ¼”ç¤ºç¤¾åŒºæ£€æµ‹
- æ¼”ç¤ºå›¾è°±å¯è§†åŒ–

---

### 9.2 æœ€ç»ˆäº¤ä»˜ç‰©

**ä»£ç **:
- [ ] å®Œæ•´çš„åç«¯ä»£ç ï¼ˆæ‰€æœ‰æ¨¡å—ï¼‰
- [ ] å•å…ƒæµ‹è¯•ï¼ˆè¦†ç›–ç‡ > 70%ï¼‰
- [ ] é›†æˆæµ‹è¯•
- [ ] ä»£ç ç¬¦åˆè§„èŒƒï¼ˆPEP8ï¼‰

**æ–‡æ¡£**:
- [ ] APIæ–‡æ¡£ï¼ˆOpenAPIï¼‰
- [ ] éƒ¨ç½²æ–‡æ¡£
- [ ] ç”¨æˆ·æ‰‹å†Œ
- [ ] æŠ€æœ¯æ–‡æ¡£

**ç¯å¢ƒ**:
- [ ] Dockeré•œåƒ
- [ ] docker-composeé…ç½®
- [ ] ç¯å¢ƒå˜é‡è¯´æ˜
- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬

**æ¼”ç¤º**:
- [ ] å®Œæ•´åŠŸèƒ½æ¼”ç¤ºè§†é¢‘
- [ ] PPTæ¼”ç¤ºæ–‡ç¨¿

---

## 10. éªŒæ”¶æ ‡å‡†

### 10.1 åŠŸèƒ½éªŒæ”¶

**P0åŠŸèƒ½ï¼ˆå¿…é¡»å®ç°ï¼‰**:
- [x] è®ºæ–‡ä¸Šä¼ å’Œè§£æ
- [x] çŸ¥è¯†å›¾è°±æ„å»º
- [x] å›¾è°±æœç´¢
- [x] Agentæ™ºèƒ½é—®ç­”
- [x] å·¥å…·è°ƒç”¨
- [x] å¤–éƒ¨æœç´¢fallback

**P1åŠŸèƒ½ï¼ˆé‡è¦ï¼‰**:
- [x] å¯¹è¯å†å²
- [ ] ç”¨æˆ·å›¾è°±å¯è§†åŒ–ï¼ˆå«èŠ‚ç‚¹/è¾¹è¯¦æƒ…æŸ¥è¯¢ï¼‰

**P2åŠŸèƒ½ï¼ˆå¢å¼ºï¼‰**:
- [x] ç¤¾åŒºæ£€æµ‹
- [ ] å›¾è°±ç»Ÿè®¡æ¦‚è§ˆ

### 10.2 æ€§èƒ½éªŒæ”¶

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹è¯•æ–¹æ³• | æ˜¯å¦é€šè¿‡ |
|-----|------|---------|---------|
| APIå“åº”æ—¶é—´ | P95 < 3ç§’ | å‹åŠ›æµ‹è¯• | [ ] |
| å›¾è°±æ•°æ®è·å– | < 5ç§’ï¼ˆ5000èŠ‚ç‚¹ï¼‰ | æ€§èƒ½æµ‹è¯• | [ ] |
| èŠ‚ç‚¹è¯¦æƒ…æŸ¥è¯¢ | < 500ms | æ€§èƒ½æµ‹è¯• | [ ] |
| å¹¶å‘ç”¨æˆ· | 100+ | JMeteræµ‹è¯• | [ ] |
| è®ºæ–‡è§£æå‡†ç¡®ç‡ | > 85% | äººå·¥æŠ½æ · | [ ] |
| æ¨èç²¾å‡†åº¦ | > 60% | ç”¨æˆ·åé¦ˆ | [ ] |
| ç³»ç»Ÿå¯ç”¨æ€§ | > 99% | ç›‘æ§ç»Ÿè®¡ | [ ] |

### 10.3 è´¨é‡éªŒæ”¶

- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 70%
- [ ] æ‰€æœ‰P0åŠŸèƒ½æœ‰é›†æˆæµ‹è¯•
- [ ] æ— P0/P1çº§åˆ«bug
- [ ] P2çº§åˆ«bug < 5ä¸ª
- [ ] ä»£ç é€šè¿‡Lintæ£€æŸ¥
- [ ] APIæ–‡æ¡£å®Œæ•´

### 10.4 éªŒæ”¶æµç¨‹

1. **å¼€å‘è‡ªæµ‹**: å¼€å‘äººå‘˜å®Œæˆæ¨¡å—åè‡ªæµ‹
2. **ä»£ç å®¡æŸ¥**: PRæäº¤ï¼Œè‡³å°‘1äººReview
3. **QAæµ‹è¯•**: æµ‹è¯•å·¥ç¨‹å¸ˆæ‰§è¡Œæµ‹è¯•ç”¨ä¾‹
4. **é›†æˆæµ‹è¯•**: å¤šæ¨¡å—è”è°ƒæµ‹è¯•
5. **ç”¨æˆ·éªŒæ”¶**: PMå’Œäº§å“ç»ç†éªŒæ”¶
6. **éƒ¨ç½²ä¸Šçº¿**: DevOpséƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

---

## 11. é£é™©ç®¡ç†

### 11.1 æŠ€æœ¯é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|-----|------|------|---------|
| LLM APIé™æµ | ä¸­ | é«˜ | å®ç°è¯·æ±‚é˜Ÿåˆ—ï¼Œæ·»åŠ é‡è¯•æœºåˆ¶ |
| Neo4jæ€§èƒ½ç“¶é¢ˆ | ä¸­ | é«˜ | ä¼˜åŒ–æŸ¥è¯¢ï¼Œæ·»åŠ ç´¢å¼•ï¼Œè€ƒè™‘åˆ†ç‰‡ |
| PDFè§£æå¤±è´¥ç‡é«˜ | ä¸­ | ä¸­ | å¤šä¸ªè§£æå™¨å¤‡ç”¨ï¼Œäººå·¥æ ¡éªŒ |
| å®ä½“æŠ½å–å‡†ç¡®ç‡ä½ | é«˜ | é«˜ | ä¼˜åŒ–Promptï¼Œæ·»åŠ åå¤„ç†è§„åˆ™ |
| å¤–éƒ¨APIä¸ç¨³å®š | ä¸­ | ä¸­ | æ·»åŠ ç¼“å­˜ï¼Œå®ç°é™çº§æ–¹æ¡ˆ |

### 11.2 è¿›åº¦é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|-----|------|------|---------|
| éœ€æ±‚å˜æ›´ | ä¸­ | é«˜ | å†»ç»“éœ€æ±‚ï¼Œå˜æ›´èµ°è¯„å®¡æµç¨‹ |
| äººå‘˜å˜åŠ¨ | ä½ | é«˜ | ä»£ç æ–‡æ¡£å®Œå–„ï¼ŒçŸ¥è¯†å…±äº« |
| æŠ€æœ¯éš¾ç‚¹å¡ä½ | ä¸­ | ä¸­ | æå‰æŠ€æœ¯æ”»å…³ï¼Œå¯»æ±‚å¤–éƒ¨æ”¯æŒ |
| æµ‹è¯•æ—¶é—´ä¸è¶³ | ä¸­ | ä¸­ | TDDå¼€å‘ï¼Œè¾¹å¼€å‘è¾¹æµ‹è¯• |

### 11.3 èµ„æºé£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|-----|------|------|---------|
| OpenAIæˆæœ¬è¿‡é«˜ | ä¸­ | ä¸­ | ç›‘æ§ç”¨é‡ï¼Œä¼˜åŒ–è°ƒç”¨æ¬¡æ•° |
| æœåŠ¡å™¨èµ„æºä¸è¶³ | ä½ | ä¸­ | äº‘æœåŠ¡æŒ‰éœ€æ‰©å®¹ |
| ç¬¬ä¸‰æ–¹æœåŠ¡æ•…éšœ | ä½ | é«˜ | å…³é”®æœåŠ¡å¤šå¤‡ä»½ |

### 11.4 é£é™©ç›‘æ§

- **æ¯æ—¥**: æ£€æŸ¥å…³é”®æŒ‡æ ‡ï¼ˆAPIæˆåŠŸç‡ã€LLMç”¨é‡ï¼‰
- **æ¯å‘¨**: Reviewé£é™©æ¸…å•ï¼Œæ›´æ–°åº”å¯¹æªæ–½
- **æ¯æœˆ**: æ€»ç»“é£é™©ç»éªŒï¼Œä¼˜åŒ–é£é™©ç®¡ç†

---

## 12. é™„å½•

### 12.1 æœ¯è¯­è¡¨

| æœ¯è¯­ | å®šä¹‰ |
|-----|------|
| Graphiti | çŸ¥è¯†å›¾è°±æ¡†æ¶ï¼ŒåŸºäºNeo4j |
| Episode | Graphitiä¸­çš„æ•°æ®å•å…ƒï¼Œä»£è¡¨ä¸€æ¬¡æ•°æ®æ‘„å…¥ |
| Entity | å®ä½“ï¼Œå¦‚Paperã€Methodã€Dataset |
| Relation | å…³ç³»ï¼Œå¦‚PROPOSESã€CITES |
| Community | ç¤¾åŒºï¼Œç›¸å…³å®ä½“çš„èšç±» |
| Agent | AIä»£ç†ï¼Œå¯ä»¥è°ƒç”¨å·¥å…·å®Œæˆä»»åŠ¡ |
| Tool | Agentå¯è°ƒç”¨çš„åŠŸèƒ½æ¨¡å— |
| Namespace | å›¾è°±å‘½åç©ºé—´ï¼Œç”¨äºéš”ç¦»ç”¨æˆ·æ•°æ® |
| Fallback | é™çº§æœºåˆ¶ï¼Œå½“ä¸»è¦æ–¹æ³•å¤±è´¥æ—¶çš„å¤‡é€‰æ–¹æ¡ˆ |

### 12.2 å‚è€ƒæ–‡æ¡£

- **Graphiti APIæ–‡æ¡£**: `Graphiti APIæ–‡æ¡£.md`
- **åŠŸèƒ½éœ€æ±‚æ¸…å•**: `functional-requirements.md`
- **æ¶æ„åˆ†æ**: `å¼€å‘æ—¥å¿—/æ¶æ„åˆ†æä¸æ”¹è¿›æ–¹æ¡ˆ.md`
- **å¼€å‘TodoList**: `å¼€å‘æ—¥å¿—/é¡¹ç›®åç«¯å¼€å‘TodoList.md`

### 12.3 è”ç³»æ–¹å¼

| è§’è‰² | å§“å | é‚®ç®± | é’‰é’‰/ä¼å¾® |
|-----|------|------|----------|
| é¡¹ç›®ç»ç† | [PM] | pm@example.com | - |
| æŠ€æœ¯è´Ÿè´£äºº | [TL] | tl@example.com | - |

---

## ğŸ“ æ–‡æ¡£å˜æ›´è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®æ”¹äºº | ä¿®æ”¹å†…å®¹ |
|-----|------|--------|---------|
| v1.0 | 2025-12-09 | PM | åˆå§‹ç‰ˆæœ¬ |
| v1.1 | 2025-12-09 | PM | æ–°å¢ç¬¬5ç« ï¼šæ•°æ®éœ€æ±‚ï¼ˆ10ä¸ªå­éœ€æ±‚ï¼‰ |
| v1.2 | 2025-12-09 | PM | æ–°å¢Module Hï¼šç”¨æˆ·è®¤è¯ï¼ˆ7ä¸ªå­éœ€æ±‚ï¼‰<br>æ•°æ®åº“æ”¹ä¸ºMySQL + Alembic |
| v1.3 | 2025-12-09 | PM | ç®€åŒ–MVPèŒƒå›´ï¼š<br>- ç§»é™¤user_role<br>- å‰åç«¯èŒè´£æ˜ç¡®ï¼ˆéªŒè¯é€»è¾‘å‰ç½®ï¼‰<br>- åˆ é™¤A2è®ºæ–‡æŸ¥è¯¢ã€D1ç”¨æˆ·ç”»åƒã€D2é˜…è¯»å†å²ã€E2è®ºæ–‡æ¨èã€E3è®ºæ–‡å¯¹æ¯” |
| v1.4 | 2025-12-10 | PM | **é‡å¤§æ›´æ–°**ï¼šModule G å›¾è°±å¯è§†åŒ–æ¨¡å—<br>- é‡æ–°è®¾è®¡ä¸ºäº¤äº’å¼å›¾è°±å¯è§†åŒ–ï¼ˆP1ä¼˜å…ˆçº§æå‡ï¼‰<br>- REQ-G1: ç”¨æˆ·å›¾è°±æ•°æ®è·å–APIï¼ˆæ”¯æŒç­›é€‰ã€åˆ†é¡µã€å±€éƒ¨æŸ¥è¯¢ï¼‰<br>- REQ-G2: èŠ‚ç‚¹è¯¦æƒ…æŸ¥è¯¢APIï¼ˆæ”¯æŒç‚¹å‡»æŸ¥çœ‹å±æ€§ï¼‰<br>- REQ-G3: è¾¹è¯¦æƒ…æŸ¥è¯¢APIï¼ˆæ”¯æŒç‚¹å‡»æŸ¥çœ‹å…³ç³»å±æ€§ï¼‰<br>- REQ-G4: å›¾è°±ç»Ÿè®¡æ¦‚è§ˆAPI<br>- REQ-G5: èŠ‚ç‚¹é‚»å±…å±•å¼€APIï¼ˆæ”¯æŒåŒå‡»å±•å¼€ï¼‰<br>- æ‰€æœ‰APIæ”¯æŒJWTè®¤è¯å’Œæƒé™æ§åˆ¶<br>- é¢„è®¡å·¥æœŸè°ƒæ•´ä¸º1.5å‘¨ |

---

## âœ… ç­¾ç½²ç¡®è®¤

**é¡¹ç›®ç»ç†**: ________________  æ—¥æœŸ: __________

**æŠ€æœ¯è´Ÿè´£äºº**: ________________  æ—¥æœŸ: __________

**äº§å“ç»ç†**: ________________  æ—¥æœŸ: __________

---

**é¡¹ç›®å¯åŠ¨æ—¥æœŸ**: 2025-12-10  
**é¢„è®¡å®Œæˆæ—¥æœŸ**: 2026-02-09  
**å½“å‰çŠ¶æ€**: ğŸŸ¢ è¿›è¡Œä¸­

---

*æœ¬PRDä¸ºResearchAgent v1.0çš„æ­£å¼äº§å“éœ€æ±‚æ–‡æ¡£ï¼Œæ‰€æœ‰å¼€å‘å·¥ä½œåº”ä»¥æœ¬æ–‡æ¡£ä¸ºå‡†ã€‚å¦‚æœ‰ç–‘é—®æˆ–éœ€è¦æ¾„æ¸…ï¼Œè¯·è”ç³»é¡¹ç›®ç»ç†ã€‚*

